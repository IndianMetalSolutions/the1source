<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://live.zwidgets.com/js-sdk/1.2/ZohoEmbededAppSDK.min.js"></script>
    <title>1Source ERP v1</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://pro.fontawesome.com/releases/v6.0.0-beta3/css/all.css"
      rel="stylesheet"
    />
    <!--  -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!--  -->
    <script>
      // Declare global variables for account name and vendor name also other data
      let accountName = "";
      let vendorName = "";
      //
      window.MainRecordIDfor_ItemDetails = "";
      window.MainRecordIDfor_ItemDetailsso = "";
      window.MainRecordIDfor_ItemDetailsdo = "";
      //
      window.itemDetails = "";
      window.itemDetailsso = "";
      window.itemDetailsdo = "";
      //
      window.selectedEstimateID = null;
      window.selectedSalesOrderID = null;
      //
      window.genrateDate;
      window.accountId;
      //
      window.contactName = null;
      window.contactNameSO = null;
      window.contactNameDO = null;
      //
      window.addressName = null;
      window.addressNameSO = null;
      //
      window.salespersonID = null;
      window.salespersonIDSO = null;
      window.salespersonIDDO = null;
      //
      window.selectedEstimateIDDO = null;
      window.selectedDesignOrderID = null;
      //
      window.vendorName = "";
      //
      window.item = [];
      //
      window.productTypeContent = "";
      window.productTypeContentSO = "";
      window.productTypeContentDO = "";
      //
      window.productTypeContent_QT_Update = "";
      window.productTypeContent_SO_Update = "";
      window.productTypeContent_DO_Update = "";
      window.productTypeOptionQtUpdate = "";
      window.productTypeContentItemRowCreate = "";
      //
      window.locationName = "";
      window.locationNameSO = "";
      //
      window.ApproverID = "";
      //
      window.accountName = "";
      window.shippingStreetField = "";
      window.shippingStreetLine2Field = "";
      window.shippingCityField = "";
      window.shippingStateField = "";
      window.shippingCodeField = "";
      window.billingStreetField = "";
      window.billingCityField = "";
      window.billingStateField = "";
      window.billingCodeField = "";
      window.shippingName = "";
      window.shippingphoneFields = "";
      window.internalApprover = "";
      //BELOW IS SO LOCATION GLOBAL DATA
      window.billingStreetFieldSO = "";
      window.billingCityFieldSO = "";
      window.billingStateFieldSO = "";
      window.billingCodeFieldSO = "";
      //
      window.shippingNameSO = "";
      window.shippingStreetFieldSO = "";
      window.shippingStreetLine2FieldSO = "";
      window.shippingCityFieldSO = "";
      window.shippingStateFieldSO = "";
      window.shippingCodeFieldSO = "";
      window.shippingphoneFieldsSO = "";
      // Initialize Zoho Embedded App
      ZOHO.embeddedApp.on("PageLoad", async function (data) {
        // Resize the CRM UI
        ZOHO.CRM.UI.Resize({ height: "1920", width: "1920" }).then(function (
          resizeData
        ) {
          console.log("UI Resize successful:", resizeData);
        });
        // Retrieve the Account ID from the context
        const accountId = data.EntityId; // EntityId should be the Account ID
        // Fetch Account Details using the Account ID
        ZOHO.CRM.API.getRecord({
          Entity: "Accounts", // The module name
          RecordID: accountId, // The Account ID
        })
          .then(function (response) {
            if (response.data && response.data.length > 0) {
              const accountDetails = response.data[0];
              // Update global variables
              accountName = accountDetails.Account_Name || "N/A";
              vendorName = accountDetails.Vendor_number || "N/A";
              window.accountId = accountDetails.id;
              window.accountName = accountName;
              window.vendorName = vendorName;
              // Pre-fill form fields with account details
              document.getElementById("accountNameQT").value = accountName;
              document.getElementById("vendorNumberQT").value = vendorName;
              document.getElementById("accountNameSO").value = accountName;
              document.getElementById("vendorNumberSO").value = vendorName;
              document.getElementById("accountNameDO").value = accountName;
              // Fetch Contacts under the Account
              ZOHO.CRM.API.getRelatedRecords({
                Entity: "Accounts", // Related module
                RecordID: accountId, // The Account ID
                RelatedList: "Contacts", // Related list name
              })
                .then(function (contactResponse) {
                  if (contactResponse.data && contactResponse.data.length > 0) {
                    // Populate dropdown field with contacts For Estimate
                    const contactDropdown =
                      document.getElementById("contactSelectField");
                    if (contactDropdown) {
                      contactResponse.data.forEach((contact) => {
                        const option = document.createElement("option");
                        option.value = contact.id;
                        option.textContent =
                          contact.Full_Name || "Unnamed Contact";
                        contactDropdown.appendChild(option);
                      });
                      // Listen for changes in the dropdown to set the global contact name
                      contactDropdown.addEventListener(
                        "change",
                        function (event) {
                          const selectedContactId = event.target.value;
                          const selectedContact = contactResponse.data.find(
                            (contact) => contact.id === selectedContactId
                          );
                          if (selectedContact) {
                            window.contactName =
                              selectedContact.Full_Name || "Unnamed Contact";
                            console.log(
                              "Global Contact Name set to:",
                              window.contactName
                            );
                          } else {
                            console.warn("Selected contact not found.");
                          }
                        }
                      );
                    } else {
                      console.warn(
                        'Dropdown field with ID "contactSelectField" not found.'
                      );
                    }
                    // contact field for SO
                    const soContact = document.getElementById(
                      "contactSelectFieldSO"
                    );
                    if (soContact) {
                      contactResponse.data.forEach((contactSO) => {
                        const option1 = document.createElement("option");
                        option1.value = contactSO.id;
                        option1.textContent =
                          contactSO.Full_Name || "Unnamed Contact";
                        soContact.appendChild(option1);
                      });
                      // Listen for changes in the dropdown to set the global contact name
                      soContact.addEventListener("change", function (event) {
                        const selectedContactIdSO = event.target.value;
                        const selectedContactSO = contactResponse.data.find(
                          (contactSO) => contactSO.id === selectedContactIdSO
                        );
                        if (selectedContactSO) {
                          window.contactNameSO =
                            selectedContactSO.Full_Name || "Unnamed Contact";
                          console.log(
                            "Global Contact Name set for SO:",
                            window.contactNameSO
                          );
                        } else {
                          console.warn("Selected contact not found SO.");
                        }
                      });
                    } else {
                      console.warn(
                        'Dropdown field with ID "contactSelectField SO" not found.'
                      );
                    }
                    //above Contact details is for SO field
                    // contact field for SO
                    const doContact = document.getElementById(
                      "contactSelectFieldDO"
                    );
                    if (doContact) {
                      contactResponse.data.forEach((contactDO) => {
                        const optiondo = document.createElement("option");
                        optiondo.value = contactDO.id;
                        optiondo.textContent =
                          contactDO.Full_Name || "Unnamed Contact";
                        doContact.appendChild(optiondo);
                      });
                      // Listen for changes in the dropdown to set the global contact name
                      doContact.addEventListener("change", function (event) {
                        const selectedContactIdDO = event.target.value;
                        const selectedContactDO = contactResponse.data.find(
                          (contactDO) => contactDO.id === selectedContactIdDO
                        );
                        if (selectedContactDO) {
                          window.contactNameDO =
                            selectedContactDO.Full_Name || "Unnamed Contact";
                          console.log(
                            "Global Contact Name set for DO:",
                            window.contactNameDO
                          );
                        } else {
                          console.warn("Selected contact not found DO.");
                        }
                      });
                    } else {
                      console.warn(
                        'Dropdown field with ID "contactSelectField DO" not found.'
                      );
                    }
                    //above Contact details is for DO field
                  } else {
                    console.warn(
                      "No contacts found for the provided Account ID."
                    );
                  }
                })
                .catch(function (contactError) {
                  console.error("Error fetching contacts:", contactError);
                });
              //above is contact related list
              // Fetch Address under the Account for QT
              ZOHO.CRM.API.getRelatedRecords({
                Entity: "Accounts", // Related module
                RecordID: accountId, // The Account ID
                RelatedList: "Address", // Related list name
              }).then(
                (response) => {
                  const result = response.data;
                  //below code is for Location field for QT
                  const addressSelect =
                    document.getElementById("addressSelectField");
                  addressSelect.innerHTML =
                    "<option value=''>Select an address</option>"; // Reset options
                  // Populate address dropdown
                  if (result) {
                    const option1 = document.createElement("option");
                    result.forEach((AddressData) => {
                      const option = document.createElement("option");
                      option.value = AddressData.Name;
                      if (option1.value.length === 0) {
                        option1.value = AddressData.Accounts.name;
                        option1.textContent = `${AddressData.Accounts.name}`;
                        addressSelect.appendChild(option1);
                      }
                      option.textContent = `${AddressData.Name}`;
                      addressSelect.appendChild(option);
                      // Assign the location name globally
                      window.locationName = AddressData.Accounts.name;
                    });
                    //console.log("Global location name:", window.locationName);
                  } else {
                    console.warn(
                      "No related contacts found for the selected account Address"
                    );
                  }
                  const shippingName =
                    document.getElementById("shippingNameQT");
                  const shippingStreetField =
                    document.getElementById("shippingStreet");
                  const shippingStreetLine2Field = document.getElementById(
                    "Address_line2_CRMQT"
                  );
                  const shippingCityField =
                    document.getElementById("shippingCity");
                  const shippingStateField =
                    document.getElementById("shippingState");
                  const billing_Name_CRM =
                    document.getElementById("billingNameQT");
                  const shippingCodeField =
                    document.getElementById("shippingCode");
                  const billingStreetField =
                    document.getElementById("billingStreet");
                  const billingCityField =
                    document.getElementById("billingCity");
                  const billingStateField =
                    document.getElementById("billingState");
                  const billingCodeField =
                    document.getElementById("billingCode");
                  const CRMshipingphone = document.getElementById("phoneQT");
                  //
                  addressSelect.addEventListener("change", (e) => {
                    window.addressName = e.target.value;
                    //
                    const addTechniue = result.map((dd) => {
                      if (dd.Name !== e.target.value) {
                        return 0;
                      } else {
                        return 1;
                      }
                    });
                    function allElementEual(arr) {
                      return (
                        arr.length === 0 || arr.every((val) => val === arr[0])
                      );
                    }
                    const resultAddress1 = allElementEual(addTechniue);
                    if (resultAddress1) {
                      billing_Name_CRM.value = window.accountName;
                      //billing for main address
                      window.billingStreetField = result[0].Billing_Street;
                      window.billingCityField = result[0].Billing_City;
                      window.billingStateField = result[0].Billing_State;
                      window.billingCodeField = result[0].Billing_Code;
                      //shipping for maian account
                      shippingName.value = window.accountName;
                      window.shippingStreetField = result[0].Billing_Street;
                      window.shippingCityField = result[0].Billing_City;
                      window.shippingStateField = result[0].Billing_State;
                      window.shippingCodeField = result[0].Billing_Code;
                      //billing for main address
                      billingStreetField.value = window.billingStreetField;
                      billingCityField.value = window.billingCityField;
                      billingStateField.value = window.billingStateField;
                      billingCodeField.value = window.billingCodeField;
                      //shipping for maian account
                      shippingStreetField.value = window.shippingStreetField;
                      shippingCityField.value = window.shippingCityField;
                      shippingStateField.value = window.shippingStateField;
                      shippingCodeField.value = window.shippingCodeField;
                      CRMshipingphone.value = "";
                      window.shippingphoneFields = "";
                    }
                    //billing and shipping for other address
                    const selectedAddress = result.find(
                      (AddressData) => AddressData.Name === e.target.value
                    );
                    if (selectedAddress) {
                      // Populate shipping address fields
                      CRMshipingphone.value = selectedAddress.Shipping_Phone;
                      window.shippingphoneFields =
                        selectedAddress.Shipping_Phone;
                      billing_Name_CRM.value = window.accountName;
                      shippingStreetField.value =
                        selectedAddress.Shipping_Street ||
                        "No street for this address.";
                      window.shippingStreetField = shippingStreetField.value;
                      shippingStreetLine2Field.value =
                        selectedAddress.Shipping_Street_Line_2 || "";
                      window.shippingStreetLine2Field =
                        shippingStreetLine2Field.value;
                      shippingCityField.value =
                        selectedAddress.Shipping_City || "";
                      window.shippingCityField = shippingCityField.value;
                      shippingStateField.value =
                        selectedAddress.Shipping_State || "";
                      window.shippingStateField = shippingStateField.value;
                      shippingCodeField.value =
                        selectedAddress.Shipping_Code || "";
                      window.shippingCodeField = shippingCodeField.value;
                      shippingName.value = selectedAddress.Name;
                      window.shippingName = shippingName.value;
                      // Populate billing address fields
                      billingStreetField.value =
                        selectedAddress.Billing_Street || "";
                      window.billingStreetField = billingStreetField.value;
                      billingCityField.value =
                        selectedAddress.Billing_City || "";
                      window.billingCityField = billingCityField.value;
                      billingStateField.value =
                        selectedAddress.Billing_State || "";
                      window.billingStateField = billingStateField.value;
                      billingCodeField.value =
                        selectedAddress.Billing_Code || "";
                      window.billingCodeField = billingCodeField.value;
                    }
                  });
                  // Below is for SO Location
                  const resultSO = response.data;
                  const addressSelectSO = document.getElementById(
                    "addressSelectFieldSO"
                  );
                  addressSelectSO.innerHTML =
                    "<option value=''>Select an address</option>";
                  if (resultSO) {
                    const optionSO1 = document.createElement("option");
                    resultSO.forEach((AddressDataSO) => {
                      const optionSO = document.createElement("option");
                      optionSO.value = AddressDataSO.Name;
                      if (optionSO1.value.length === 0) {
                        optionSO1.value = AddressDataSO.Accounts.name;
                        optionSO1.textContent = `${AddressDataSO.Accounts.name}`;
                        addressSelectSO.appendChild(optionSO1);
                      }
                      optionSO.textContent = `${AddressDataSO.Name}`;
                      addressSelectSO.appendChild(optionSO);
                      // Assign the location name globally
                      window.locationNameSO = AddressDataSO.Accounts.name;
                    });
                    //console.log("Global location name for SO:", window.locationNameSO);
                  } else {
                    console.warn(
                      "No related contacts found for the selected account Address"
                    );
                  }
                  const shippingNameSO =
                    document.getElementById("shippingNameSO");
                  const shippingStreetFieldSO =
                    document.getElementById("shippingStreetSO");
                  const shippingStreetLine2FieldSO = document.getElementById(
                    "Address_line2_CRMSO"
                  );
                  const shippingCityFieldSO =
                    document.getElementById("shippingCitySO");
                  const shippingStateFieldSO =
                    document.getElementById("shippingStateSO");
                  const billing_Name_CRMSO =
                    document.getElementById("billingNameSO");
                  const shippingCodeFieldSO =
                    document.getElementById("shippingCodeSO");
                  const billingStreetFieldSO =
                    document.getElementById("billingStreetSO");
                  const billingCityFieldSO =
                    document.getElementById("billingCitySO");
                  const billingStateFieldSO =
                    document.getElementById("billingStateSO");
                  const billingCodeFieldSO =
                    document.getElementById("billingCodeSO");
                  const CRMshipingphoneSO = document.getElementById("phoneSO");
                  // Below is SO onchange
                  addressSelectSO.addEventListener("change", (e) => {
                    window.addressNameSO = e.target.value;
                    //
                    const addTechniueSO = result.map((dd) => {
                      if (dd.Name !== e.target.value) {
                        return 0;
                      } else {
                        return 1;
                      }
                    });
                    function allElementEualSO(arrso) {
                      return (
                        arrso.length === 0 ||
                        arrso.every((val) => val === arrso[0])
                      );
                    }
                    const resultAddress1SO = allElementEualSO(addTechniueSO);
                    if (resultAddress1SO) {
                      billing_Name_CRMSO.value = window.accountName;
                      //billing for main address FOR SO
                      window.billingStreetFieldSO = result[0].Billing_Street;
                      window.billingCityFieldSO = result[0].Billing_City;
                      window.billingStateFieldSO = result[0].Billing_State;
                      window.billingCodeFieldSO = result[0].Billing_Code;
                      //shipping for maian account
                      shippingNameSO.value = window.accountName;
                      window.shippingStreetFieldSO = result[0].Billing_Street;
                      window.shippingCityFieldSO = result[0].Billing_City;
                      window.shippingStateFieldSO = result[0].Billing_State;
                      window.shippingCodeFieldSO = result[0].Billing_Code;
                      console.log("SO LOCATION IS LOADED");
                      //billing for main address FOR SO
                      billingStreetFieldSO.value = window.billingStreetFieldSO;
                      billingCityFieldSO.value = window.billingCityFieldSO;
                      billingStateFieldSO.value = window.billingStateFieldSO;
                      billingCodeFieldSO.value = window.billingCodeFieldSO;
                      //shipping for maian account FOR SO
                      shippingStreetFieldSO.value =
                        window.shippingStreetFieldSO;
                      shippingCityFieldSO.value = window.shippingCityFieldSO;
                      shippingStateFieldSO.value = window.shippingStateFieldSO;
                      shippingCodeFieldSO.value = window.shippingCodeFieldSO;
                      CRMshipingphoneSO.value = "";
                      window.shippingphoneFieldsSO = "";
                    }
                    //billing and shipping for other address
                    const selectedAddressSO = result.find(
                      (AddressDataSO) => AddressDataSO.Name === e.target.value
                    );
                    if (selectedAddressSO) {
                      // Populate shipping address fields
                      CRMshipingphoneSO.value =
                        selectedAddressSO.Shipping_Phone;
                      window.shippingphoneFieldsSO =
                        selectedAddressSO.Shipping_Phone;
                      billing_Name_CRMSO.value = window.accountName;
                      shippingStreetFieldSO.value =
                        selectedAddressSO.Shipping_Street ||
                        "No street for this address.";
                      window.shippingStreetFieldSO =
                        shippingStreetFieldSO.value;
                      shippingStreetLine2FieldSO.value =
                        selectedAddressSO.Shipping_Street_Line_2 || "";
                      window.shippingStreetLine2FieldSO =
                        shippingStreetLine2FieldSO.value;
                      shippingCityFieldSO.value =
                        selectedAddressSO.Shipping_City || "";
                      window.shippingCityFieldSO = shippingCityFieldSO.value;
                      shippingStateFieldSO.value =
                        selectedAddressSO.Shipping_State || "";
                      window.shippingStateFieldSO = shippingStateFieldSO.value;
                      shippingCodeFieldSO.value =
                        selectedAddressSO.Shipping_Code || "";
                      window.shippingCodeFieldSO = shippingCodeFieldSO.value;
                      shippingNameSO.value = selectedAddressSO.Name;
                      window.shippingNameSO = shippingNameSO.value;
                      // Populate billing address fields
                      billingStreetFieldSO.value =
                        selectedAddressSO.Billing_Street || "";
                      window.billingStreetFieldSO = billingStreetFieldSO.value;
                      billingCityFieldSO.value =
                        selectedAddressSO.Billing_City || "";
                      window.billingCityFieldSO = billingCityFieldSO.value;
                      billingStateFieldSO.value =
                        selectedAddressSO.Billing_State || "";
                      window.billingStateFieldSO = billingStateFieldSO.value;
                      billingCodeFieldSO.value =
                        selectedAddressSO.Billing_Code || "";
                      window.billingCodeFieldSO = billingCodeFieldSO.value;
                    }
                  });
                  //  ABOVE IS SO LOCATION
                  // Update the location put the code below for QT SO and DO

                  //
                  //
                  //
                },
                (error) => {
                  console.error("Error during search:", error);
                }
              );
              //above is Address related list
            } else {
              console.warn(
                "No account data found for the provided Account ID."
              );
            }
          })
          .catch(function (error) {
            console.error("Error fetching account details:", error);
          });
        // to fetch salespersons from Zoho Creator
        const conn_name_EMP = "crmwidgetconnection";
        const apiUrl_EMP =
          "https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/All_Employees";
        const req_data_EMP = {
          parameters: {},
          headers: {
            "Content-Type": "application/json", // Default content type
          },
          method: "GET", // Use GET method for fetching data
          url: apiUrl_EMP, // Zoho Creator API URL
          param_type: 1, // Set appropriate parameter type
        };
        // Invoke the Zoho Creator API
        await ZOHO.CRM.CONNECTION.invoke(conn_name_EMP, req_data_EMP)
          .then(function (response) {
            if (response.code === "SUCCESS") {
              const salespersons = response.details.statusMessage.data;
              const selectField = document.getElementById("salespersonSelect");
              salespersons.forEach((salesperson) => {
                const option = document.createElement("option");
                option.value = salesperson.ID;
                option.textContent = salesperson.Name.zc_display_value; // Display name
                selectField.appendChild(option);
              });
              const ApproverData = response.details.statusMessage.data;
              const approverQT = document.getElementById("approverQT");
              ApproverData.forEach((salesperson1) => {
                const option = document.createElement("option");
                option.value = salesperson1.ID;
                option.textContent = salesperson1.Name.zc_display_value; // Display name
                approverQT.appendChild(option);
              });
              const salespersonsso = response.details.statusMessage.data;
              const selectFieldSO = document.getElementById(
                "salespersonSelectSO"
              );
              salespersonsso.forEach((salesperson2) => {
                const optionSO = document.createElement("option");
                optionSO.value = salesperson2.ID;
                optionSO.textContent = salesperson2.Name.zc_display_value; // Display name
                selectFieldSO.appendChild(optionSO);
              });
              //salesperson for DO field
              const salespersonsdo = response.details.statusMessage.data;
              const selectFieldDO = document.getElementById(
                "salespersonSelectDO"
              );
              salespersonsdo.forEach((salesperson3) => {
                const optionDO = document.createElement("option");
                optionDO.value = salesperson3.ID;
                optionDO.textContent = salesperson3.Name.zc_display_value; // Display name
                selectFieldDO.appendChild(optionDO);
              });
              //
            } else {
              console.warn("No salespersons found or API failed:", response);
            }
          })
          .catch(function (error) {
            console.error("Error fetching salespersons:", error);
          });
        // Handle select field change event
        const selectField = document.getElementById("salespersonSelect");
        selectField.addEventListener("change", function (event) {
          const selectedSalesPersonID = event.target.value.trim();
          window.salespersonID = selectedSalesPersonID;
        });
        // Handle select field change event
        const approverQT = document.getElementById("approverQT");
        approverQT.addEventListener("change", function (event) {
          const selectedSalesPersonID = event.target.value.trim();
          window.ApproverID = selectedSalesPersonID;
          console.log("Global Approver ID updated:", window.ApproverID);
        });
        // Handle select field change event for salesorder
        const selectFieldSO = document.getElementById("salespersonSelectSO");
        selectFieldSO.addEventListener("change", function (event) {
          const selectedSalesPersonIDSO = event.target.value.trim();
          window.salespersonIDSO = selectedSalesPersonIDSO;
          console.log(
            "Global Salesperson ID updated For Salesorder:",
            window.salespersonIDSO
          );
        });
        // Handle select field change event for salesorder
        const selectFieldDO = document.getElementById("salespersonSelectDO");
        selectFieldDO.addEventListener("change", function (event) {
          const selectedSalesPersonIDDO = event.target.value.trim();
          window.salespersonIDDO = selectedSalesPersonIDDO;
          console.log(
            "Global Salesperson ID updated For Salesorder DO field:",
            window.salespersonIDDO
          );
        });
        //above data is from zoho creator salesperson with approver and salesorder for SO and DO details data

        // Below is for Product Type of estimate item
        const conn_name_ProductType = "crmwidgetconnection";
        const apiUrl_ProductType =
          "https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/All_Product_Types";
        const req_data_ProductType = {
          parameters: {},
          headers: {
            "Content-Type": "application/json", // Default content type
          },
          method: "GET", // Use GET method for fetching data
          url: apiUrl_ProductType, // Zoho Creator API URL
          param_type: 1, // Set appropriate parameter type
        };
        // Invoke the Zoho Creator API
        await ZOHO.CRM.CONNECTION.invoke(
          conn_name_ProductType,
          req_data_ProductType
        ).then(
          function (response) {
            //Product type for QT Creating record
            if (response.code === "SUCCESS") {
              const All_Product_Types = response.details.statusMessage.data;
              //console.log("Product Type from Creator:",All_Product_Types);
              const productTypeQT = document.querySelector(".productTypeQT");
              window.productTypeContent = All_Product_Types;
              All_Product_Types.forEach((ProductType) => {
                const option = document.createElement("option");
                option.value = ProductType.ID; // Set the unique ID as the value
                option.textContent = ProductType.Type_field;
                productTypeQT.appendChild(option);
              });
            }
            //Product type for SO Creating record
            if (response.code === "SUCCESS") {
              const All_Product_TypesSO = response.details.statusMessage.data;
              //console.log("Product Type from Creator:",All_Product_TypesSO);
              const productTypeSO = document.querySelector(".productTypeSO");
              window.productTypeContentSO = All_Product_TypesSO;
              All_Product_TypesSO.forEach((ProductType1) => {
                const optionSO = document.createElement("option");
                optionSO.value = ProductType1.ID; // Set the unique ID as the value
                optionSO.textContent = ProductType1.Type_field;
                productTypeSO.appendChild(optionSO);
              });
            }
            //Product type for DO Creating record
            if (response.code === "SUCCESS") {
              const All_Product_TypesDO = response.details.statusMessage.data;
              // console.log(
              //   "Product Type from Creator for DO:",
              //   All_Product_TypesDO
              // );
              const productTypeDO = document.querySelector(".productTypeDO");
              window.productTypeContentDO = All_Product_TypesDO;
              All_Product_TypesDO.forEach((ProductTypeDO1) => {
                const optionDO = document.createElement("option");
                optionDO.value = ProductTypeDO1.ID; // Set the unique ID as the value
                optionDO.textContent = ProductTypeDO1.Type_field;
                productTypeDO.appendChild(optionDO);
              });
            }
            ////Product type for QT Update
            if (response.code === "SUCCESS") {
              const All_Product_Types_QT_Update =
                response.details.statusMessage.data;
              window.productTypeContent_QT_Update = All_Product_Types_QT_Update;
            }
            ////Product type for SO Update
            if (response.code === "SUCCESS") {
              const All_Product_Types_SO_Update =
                response.details.statusMessage.data;
              window.productTypeContent_SO_Update = All_Product_Types_SO_Update;
            }
            ////Product type for DO Update
            if (response.code === "SUCCESS") {
              const All_Product_Types_DO_Update =
                response.details.statusMessage.data;
              window.productTypeContent_DO_Update = All_Product_Types_DO_Update;
            }
            //Product type for QT Creating item record into Update QT
            // if (response.code === "SUCCESS") {
            //   const All_Product_TypesItemRowCreate =
            //     response.details.statusMessage.data;
            //   console.log(
            //     "Product Type from Creating Item into QT Update:",
            //     All_Product_TypesItemRowCreate
            //   );
            //   const productTypeQTItemRowCreate = document.getElementById(
            //     "productTypeAddRowQT"
            //   );
            //   console.log(
            //     "Product Type Item Row Create: productTypeQTItemRowCreate",
            //     productTypeQTItemRowCreate
            //   );
            //   window.productTypeContentItemRowCreate =
            //     All_Product_TypesItemRowCreate;
            //   All_Product_TypesItemRowCreate.forEach(
            //     (ProductTypeItemCreate) => {
            //       const optionItemCreate = document.createElement("option");
            //       optionItemCreate.value = ProductTypeItemCreate.ID; // Set the unique ID as the value
            //       optionItemCreate.textContent =
            //         ProductTypeItemCreate.Type_field;
            //       productTypeQTItemRowCreate.appendChild(optionItemCreate);
            //     }
            //   );
            // }
            //
          },
          function (errorResponse) {
            console.error("Error Response:", errorResponse);
          }
        );
        //above is for Product Type of estimate item
        //
        // Fetch and display Estimate Report Data
        const conn_name_QTReport = "crmwidgetconnection";
        const accountIdDataCRM =
          typeof window !== "undefined" && window.accountId
            ? window.accountId
            : "DEFAULT_ACCOUNT_ID";
        const criteriaQT = encodeURIComponent(
          `(CRM_Account_Name == "${accountIdDataCRM}")`
        );
        const apiUrl_QTReport = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/QT_For_CRM_widget_Update?criteria=${criteriaQT}`;
        //
        const req_data_QTReport = {
          parameters: {},
          headers: {
            "Content-Type": "application/json",
          },
          method: "GET",
          url: apiUrl_QTReport,
          param_type: 1,
        };
        // Declare global arrays
        let globalItemsArray = [];
        window.globalItemsArray = globalItemsArray;
        // Function to fetch and process Estimate data
        async function fetchEstimateReports() {
          try {
            const response = await ZOHO.CRM.CONNECTION.invoke(
              conn_name_QTReport,
              req_data_QTReport
            );
            if (
              response.code === "SUCCESS" &&
              response.details.statusMessage?.data
            ) {
              const QTReport = response.details.statusMessage.data;
              //console.log("QT Report data:", QTReport);
              if (!Array.isArray(QTReport)) {
                console.error(
                  "QT Report data is not in array format:",
                  QTReport
                );
                return;
              }
              // Update global arrays
              globalItemsArray = [...QTReport];
              // Ensure global accessibility
              window.globalItemsArray = globalItemsArray;
              // Populate the table with fetched data
              populateEstimateTable(QTReport);
              // Fetch items **AFTER** estimates are populated
            } else {
              console.error("API Response Error:", response);
            }
          } catch (error) {
            console.error("Error Fetching Estimate Data:", error);
          }
        }
        // Function to populate the estimate table
        function populateEstimateTable(data) {
          globalItemsArray = [...data];
          //console.log("Global Items Array QT:", globalItemsArray);
          window.globalItemsArray = globalItemsArray;
          // console.log(
          //   "Global Items Array QT window.globalItemsArray:",
          //   window.globalItemsArray
          // );
          const tableBody = document.querySelector("#estimateTable tbody");
          const estimateCountSpan = document.querySelector("#estimateCount");

          if (!tableBody) {
            console.error("Table body #estimateTable tbody not found!");
            return;
          }
          tableBody.innerHTML = ""; // Clear previous rows

          if (data.length === 0) {
            tableBody.innerHTML =
              "<tr><td colspan='6'>No records found</td></tr>";
            return;
          }

          data.forEach((item) => {
            const row = document.createElement("tr");
            const isDraft = item.Status.toLowerCase() === "draft"; // âœ… Check if status is "Draft"
            let itemIDData = item.ID;
            // âœ… Assign record ID dynamically
            window.MainRecordIDfor_ItemDetails = itemIDData;
            //<td>${item.Status || "N/A"}</td>
            //onclick="handleEditClick('${item.ID}')">
            row.innerHTML = `
            <td>${item.Quote || "N/A"}</td>
            <td>${item.Quote_date || "N/A"}</td>
            <td>${item.Quote_name || "N/A"}</td>
            <td class="status-cellQT">${item.Status || "N/A"}</td>
            <td>${(item.Salesperson?.zc_display_value || "N/A").trim()}</td>
            <td>
              <div id="divIDItemQT" class="edit-btn" 
                data-bs-toggle="modal"
                data-bs-target="#editModal"
                data-id="${item.ID}"
                data-quote="${item.Quote || ""}"
                data-date="${item.Quote_date || ""}"
                data-quoteNameUpdate="${item.Quote_name || ""}"
                data-postProductionUpdate="${item.Post_production || ""}"
                data-DownPaymentQTUpdate = "${item.Down_Payment || ""}"
                data-PermitneededQTUpdate = "${item.Permit_needed || ""}"
                data-Site_Survey_NeededQTUpdate = "${
                  item.Site_Survey_Needed || ""
                }"
                data-LeadTimeQTUpdate = "${
                  item.Lead_time_from_approval_Days || ""
                }"
                data-notesUpdate="${item.Notes || ""}"
                data-privateNoteUpdate="${item.Private_Notes_widget || ""}"
                onclick="${
                  isDraft
                    ? `handleEditClick('${item.ID}')`
                    : `handleViewClick('${item.ID}')`
                }">
                <i style="color:${isDraft ? "green" : "blue"}" class="fa ${
              isDraft ? "fa-edit" : "fa-eye"
            }"></i>
              </div>
            </td>
`;
            tableBody.appendChild(row);
            // Apply background color based on status
            const statusCellQT = row.querySelector(".status-cellQT");
            if (isDraft) {
              statusCellQT.style.backgroundColor = "#6FC276"; // Soft green
              statusCellQT.style.color = "#000000"; // Dark gray text
            } else {
              statusCellQT.style.backgroundColor = "#e2e3e5"; // Light gray
              statusCellQT.style.color = "#000000"; // Dark gray text
            }
            //
          });
          // Update count
          estimateCountSpan.textContent = ` ${data.length}`;
        }

        async function fetchItemDetails() {
          if (!window.MainRecordIDfor_ItemDetails) {
            console.warn("âš ï¸ MainRecordIDfor_ItemDetails is not set yet.");
            return;
          }

          const recordIDforitem = window.MainRecordIDfor_ItemDetails;
          //console.log("ðŸ” Fetching details for Item ID:", recordIDforitem);

          const conn_name_GETitems = "crmwidgetconnection";
          const apiUrl_getitems = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/Estimate_2_0_Line_Items_Report?criteria=(Estimate_2_0==${recordIDforitem})`;

          const req_data_getitems = {
            method: "GET",
            url: apiUrl_getitems,
            headers: { "Content-Type": "application/json" },
          };

          try {
            //console.log("ðŸ“¡ Sending API request to:", apiUrl_getitems);
            const response = await ZOHO.CRM.CONNECTION.invoke(
              conn_name_GETitems,
              req_data_getitems
            );

            if (
              response.code === "SUCCESS" &&
              response.details?.statusMessage?.data
            ) {
              window.itemDetails = response.details.statusMessage.data;
              console.log("âœ… Updated window.itemDetails:", window.itemDetails);
            } else {
              console.warn("âš ï¸ No item details found in response:", response);
            }
          } catch (error) {
            console.error("âŒ Error fetching item details:", error);
          }
        }

        function getItemDetailsById(itemId) {
          if (!window.itemDetails || window.itemDetails.length === 0) {
            console.error("Item details not loaded yet.");
            return null;
          }
          const item = window.globalItemsArray.find(
            (item) => item.ID === itemId
          );
          //console.log(`Item Details for ${itemId}:`, item);
          return item;
        }

        // Function to handle edit button click
        window.handleEditClick = async function (itemId) {
          // Set global variable properly
          window.MainRecordIDfor_ItemDetails = itemId;
          console.log("Clicked item ID QT:", itemId);

          // Wait for fetchItemDetails to complete
          await fetchItemDetails();

          const item = getItemDetailsById(itemId);
          if (!item) {
            console.error("Item details not found for ID:", itemId);
            return;
          }

          if (item) {
            document.getElementById("quoteNameUpdate").value =
              item.Quote_name || "";
            document.getElementById("PostProductionUpdate").value =
              item.Post_production || "";
            document.getElementById("notesUpdate").value = item.Notes || "";
            document.getElementById("privateNoteUpdate").value =
              item.Private_Notes_widget || "";
            document.getElementById("downPaymentPercentQTUpdate").value =
              item.Down_Payment || "";
            document.getElementById("permitNeededQTUpdate").value =
              item.Permit_needed || "";
            document.getElementById("siteSurveyQTUpdate").value =
              item.Site_Survey_Needed || "";
            document.getElementById("leadTimeQTUpadate").value =
              item.Lead_time_from_approval_Days || "";
          }
          let ProductOption = "";
          window.productTypeContent_QT_Update.forEach((ProductTypeUpdateQT) => {
            ProductOption += `<option value="${ProductTypeUpdateQT.ID}">${ProductTypeUpdateQT.Type_field}</option>`;
          });

          const itemContainerUpdate = document.getElementById(
            "itemContainerUpdate"
          );
          let itemContainerUpdatehtml = "";
          window.itemDetails.forEach((itemQT) => {
            //console.log("Item Detail for Update:", itemQT);
            // <div onclick="removeRowQTupdate(this)" style=" width: 10px; margin-top: 25px;" >
            //   <span  style="color:red; width: 10px; height:10px; "><i class="fa fa-x hoverCSS"></i></span>
            // </div>
            itemContainerUpdatehtml += `
                    <div class="itemrowupdate" style="margin-bottom: 20px;">
                    <div class="row" id="row1" style="display: flex; align-items: center; flex-wrap: wrap; font-weight: bold;">
                           <div style="flex: 1;">
                             <label class="form-label" style="margin-bottom: 5px; display: block;">Product Type</label>
                             <select id="productTypeQTUpdate" class="productTypeQTUpdate form-select">
                               <option value="${itemQT.Product_Type1.ID}">${itemQT.Product_Type1.zc_display_value}</option>
                               ${ProductOption}
                             </select>
                           </div>
                           <div style="flex: 1;">
                                 <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                                 <input type="text" id="itemNameQTUpdate" value = "${itemQT.Item}"
                                     class="item-name-update form-control form-control-sm"
                                     style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                             </div>
                             <div style="flex: 1;">
                                 <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                                 <input type="number" id="itemqtyQTUpdate" value = "${itemQT.Qty}"
                                     class="item-code-update form-control form-control-sm"
                                     style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                             </div>
                             <div style="flex: 2;">
                                 <label for="Description" class="form-label"
                                     style="margin-bottom: 5px; display: block;">Description</label>
                                 <textarea name="Description" id="itemDescriptionQTUpdate" rows="1"
                                     class="itemDescriptionQTUpdate form-control form-control-sm" 
                                     style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; ">${itemQT.Description}</textarea>
                             </div>
                             <div style="flex: 1;">
                                 <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                                 <select id="itemUnitQTUpdate" class="itemUnitQTUpdate form-select form-select-sm"
                                     style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                     <option>${itemQT.Unit}</option>
                                     <option>Box</option>
                                     <option>Each</option>
                                     <option>Feet</option>
                                     <option>Sq Feet</option>
                                     <option>Sheet</option>
                                     <option>Pieces</option>
                                     <option>Units</option>
                                 </select>
                             </div>
                             <div style="flex: 1;">
                                 <label for="Cost" class="form-label" style="margin-bottom: 5px; display: block; font-size: medium;">Piece Cost
                                     ($)</label>
                                 <input type="number" id="priceCostQTUpdate" class="priceCostQTUpdate form-control form-control-sm"
                                     value = "${itemQT.Piece_cost}"
                                     style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                             </div>
                             <div style="flex: 1; ">
                                 <label for="Markup" class="form-label" style="margin-bottom: 5px; display: block;">Markup
                                     (%)</label>
                                 <input type="number" id="markupQTUpdate" class="markupQTUpdate form-control form-control-sm"
                                     value = "${itemQT.Margin}"
                                     style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                             </div>
                         </div>
                  </div>`;
          });

          itemContainerUpdate.innerHTML = itemContainerUpdatehtml;
        };

        //console.log("window.itemDetails 99", window.itemDetails);
        // Attach event listeners dynamically
        document.addEventListener("click", function (event) {
          const button = event.target.closest(".edit-btn");
          if (button) {
            const itemId = button.getAttribute("data-id");
            window.MainRecordIDfor_ItemDetails = itemId;
            handleEditClick(itemId);
          }
        });
        // Call function to fetch and populate estimate report
        fetchEstimateReports();

        // Fetch and display SO Report Data Below
        const conn_name_SOReport = "crmwidgetconnection";
        const accountIdDataCRMSO =
          typeof window !== "undefined" && window.accountId
            ? window.accountId
            : "DEFAULT_ACCOUNT_ID";
        const criteriaSO = encodeURIComponent(
          `(CRM_Account_Name == "${accountIdDataCRMSO}")`
        );
        const apiUrl_SOReport = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/SO_For_CRM_widget_Update?criteria=${criteriaSO}`;
        const req_data_SOReport = {
          parameters: {},
          headers: {
            "Content-Type": "application/json",
          },
          method: "GET",
          url: apiUrl_SOReport,
          param_type: 1,
        };
        // Declare global arrays
        let globalItemsArraySO = [];
        window.globalItemsArraySO = globalItemsArraySO;
        async function fetchSalesOrders() {
          try {
            const response = await ZOHO.CRM.CONNECTION.invoke(
              conn_name_SOReport,
              req_data_SOReport
            );
            if (response.code === "SUCCESS") {
              const SOReport = response.details.statusMessage.data;
              //console.log("SO Report Data is:", SOReport);
              populateTable(SOReport);

              if (!Array.isArray(SOReport)) {
                console.error(
                  "SO Report data is not in array format:",
                  SOReport
                );
                return;
              }
              // Update global arrays
              globalItemsArraySO = [...SOReport];
              //console.log("globalItemsArraySO", globalItemsArraySO);

              // Ensure global accessibility
              window.globalItemsArray = globalItemsArray;
            } else {
              console.error("API Response Error:", response);
            }
          } catch (error) {
            console.error("Error Fetching Data:", error);
          }
        }
        // Function to populate the Salesorder table
        function populateTable(data) {
          globalItemsArraySO = [...data];
          window.globalItemsArraySO = globalItemsArraySO;
          const tableBody = document.querySelector("#salesOrderTable tbody");
          const totalSalesOrderSpan = document.querySelector(
            "#totalSalesOrderCount"
          );

          if (!tableBody) {
            console.error("Table body #salesorderTable tbody not found!");
            return;
          }

          tableBody.innerHTML = ""; // Clear previous rows

          if (data.length === 0) {
            tableBody.innerHTML =
              "<tr><td colspan='6'>No records found</td></tr>";
            return;
          }
          data.forEach((order) => {
            const row = document.createElement("tr");
            const isDraftso = order.Status.toLowerCase() === "draft"; // âœ… Check if status is "Draft"
            let itemIDDataso = order.ID;
            //<td>${order.Status || "N/A"}</td>
            // âœ… Assign record ID dynamically
            window.MainRecordIDfor_ItemDetailsso = itemIDDataso;
            //console.log("window.MainRecordIDfor_ItemDetailsso", window.MainRecordIDfor_ItemDetailsso);
            row.innerHTML = `
                      <td>${order.Salesorder || "N/A"}</td>
                      <td>${order.Customer_due_date || "N/A"}</td>
                      <td>${order.SO_name || "N/A"}</td>
                      <td class="status-cellso">${order.Status || "N/A"}</td>
                      <td>${order.Post_production || "N/A"}</td>
                      <td>
                        <div id="divIDItemSO" class="edit-btnSO"
                          data-bs-toggle="modal"
                          data-bs-target="#editModalSO"
                          data-idSO="${order.ID}"
                          data-soNameUpdate="${order.SO_name || ""}"
                          data-postProductionUpdateso="${
                            order.Post_production || ""
                          }"
                          data-DownPaymentQTUpdateso = "${
                            order.Down_Payment || ""
                          }"
                          data-PermitneededQTUpdateso = "${
                            order.Permit_needed || ""
                          }"
                          data-Site_Survey_NeededQTUpdateso = "${
                            order.Site_Survey_Needed || ""
                          }"
                          data-LeadTimeQTUpdateso = "${
                            order.Lead_time_from_approval_Business_Days || ""
                          }"
                          data-notesUpdateso ="${order.Notes || ""}"
                          data-privateNoteUpdateso ="${
                            order.Private_Notes_widget || ""
                          }"
                          data-CustomerduedateSOUpdate ="${
                            order.Customer_due_date || ""
                          }"
                          data-Our_Commitment_DateUpdate ="${
                            order.Our_Commitment_Date || ""
                          }"
                          data-Approved_OnUpdate ="${order.Approved_On || ""}"
                          onclick="${
                            isDraftso
                              ? `handleEditClickSO('${order.ID}')`
                              : `handleViewClick('${order.ID}')`
                          }">
                          <i style="color:${
                            isDraftso ? "green" : "blue"
                          }" class="fa ${isDraftso ? "fa-edit" : "fa-eye"}"></i>
                        </div>
                      </td>
                  `;
            //onclick="handleEditClickSO('${order.ID}')"> the i tage is below of onclick
            //<i style="color:green" class="fa fa-edit"></i>
            tableBody.appendChild(row);

            // Apply background color based on status For Sales ordeer record
            const statusCellso = row.querySelector(".status-cellso");
            if (isDraftso) {
              statusCellso.style.backgroundColor = "#6FC276"; // Soft green
              statusCellso.style.color = "#000000"; // Dark gray text
            } else {
              statusCellso.style.backgroundColor = "#e2e3e5"; // Light gray
              statusCellso.style.color = "#000000"; // Dark gray text
            }
            //
          });
          // Update total count in the span
          totalSalesOrderSpan.textContent = ` ${data.length}`;
        }

        // âœ… Fetch items AFTER setting window.MainRecordIDfor_ItemDetails
        async function fetchItemDetailsso() {
          if (!window.MainRecordIDfor_ItemDetailsso) {
            console.warn("MainRecordIDfor_ItemDetailsso is not set yet.");
            return;
          }
          const conn_name_GETitemsso = "crmwidgetconnection";
          const recordIDforitemso = window.MainRecordIDfor_ItemDetailsso; // âœ… Use dynamically assigned value
          //console.log("Fetching items for record ID SO:", recordIDforitemso);
          const apiUrl_getitemsso = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/Salesorder_2_0_Line_Items_Report?criteria=(Salesorder_2_0==${recordIDforitemso})`;
          const req_data_getitemsso = {
            parameters: {},
            headers: {
              "Content-Type": "application/json",
            },
            method: "GET",
            url: apiUrl_getitemsso,
            param_type: 1,
          };
          try {
            const response = await ZOHO.CRM.CONNECTION.invoke(
              conn_name_GETitemsso,
              req_data_getitemsso
            );
            if (
              response.code === "SUCCESS" &&
              response.details?.statusMessage?.data
            ) {
              window.itemDetailsso = response.details.statusMessage.data;
              console.log(
                "âœ… Updated window.itemDetails SO:",
                window.itemDetailsso
              );
            } else {
              console.warn(
                "No records found. Check the criteria:",
                response.details.statusMessage.message
              );
            }
          } catch (error) {
            console.error("Error fetching item details:", error);
          }
        }

        // Function to get item details by ID
        function getItemDetailsByIdso(itemIdso) {
          if (!window.itemDetailsso || window.itemDetailsso.length === 0) {
            console.error("Item details not loaded yet.");
            return null;
          }
          const orderSO = window.globalItemsArraySO.find(
            (order) => order.ID === itemIdso
          );
          console.log(`Item Details for ID SO ${itemIdso}:`, orderSO);
          return orderSO;
        }

        // Function to handle edit button click
        window.handleEditClickSO = async function (itemIdso) {
          // Set global variable properly
          window.MainRecordIDfor_ItemDetailsso = itemIdso;
          console.log("Clicked item ID SO:", itemIdso);
          // Wait for fetchItemDetails to complete
          await fetchItemDetailsso();
          const itemso = getItemDetailsByIdso(itemIdso);
          if (!itemso) {
            console.error("Item details not found for ID:", itemIdso);
            return;
          }
          if (itemso) {
            document.getElementById("sonameUpdate").value =
              itemso.SO_name || "";
            document.getElementById("PostProductionUpdateSO").value =
              itemso.Post_production || "";
            console.log("itemso.Post_production", itemso.Post_production);
            document.getElementById("notesUpdateSO").value = itemso.Notes || "";
            document.getElementById("privateNoteUpdateSO").value =
              itemso.Private_Notes_widget || "";
            document.getElementById("downPaymentPercentUpdateso").value =
              itemso.Down_Payment || "";
            document.getElementById("permitNeededUpdateSO").value =
              itemso.Permit_needed || "";
            document.getElementById("siteSurveyUpdateSO").value =
              itemso.Site_Survey_Needed || "";
            document.getElementById("leadTimeUpadateSO").value =
              itemso.Lead_time_from_approval_Business_Days || "";
            document.getElementById("vendorInputNeededUpdateSO").value =
              itemso.Vendor_input_need || "";
            document.getElementById("designProofUpdateSO").value =
              itemso.is_Design_Proof_needed || "";
            document.getElementById("taxRateUpdateSO").value =
              itemso.Tax_rate || "";
            //
            function formatDateToYYYYMMDDso(dateStringso) {
              // Define months mapping
              const monthsso = {
                Jan: "01",
                Feb: "02",
                Mar: "03",
                Apr: "04",
                May: "05",
                Jun: "06",
                Jul: "07",
                Aug: "08",
                Sep: "09",
                Oct: "10",
                Nov: "11",
                Dec: "12",
              };
              // Split the input date (e.g., "25-Feb-2025")
              let partsso = dateStringso.split("-");
              if (partsso.length === 3) {
                let dayso = partsso[0].padStart(2, "0");
                let monthso = monthsso[partsso[1]];
                let yearso = partsso[2];

                if (monthso) {
                  return `${yearso}-${monthso}-${dayso}`;
                }
              }
              return ""; // Return empty if parsing fails
            }
            let dateValueso = itemso.Customer_due_date || "";
            // Convert the date to "yyyy-MM-dd" format if necessary
            let formattedDateso = dateValueso
              ? formatDateToYYYYMMDDso(dateValueso)
              : "";
            // Assign the correctly formatted date to the input field SO Update
            document.getElementById("Customer_due_date_SOUpdate").value =
              formattedDateso;
            let Our_Commitment_DateUpdateDataso = document.getElementById(
              "Customer_due_date_SOUpdate"
            ).value;
            //
            let Our_Commitment_Date = itemso.Our_Commitment_Date || "";
            // Convert the date to "yyyy-MM-dd" format if necessary
            let formattedDatesoOurCommitment = Our_Commitment_Date
              ? formatDateToYYYYMMDDso(Our_Commitment_Date)
              : "";
            //
            document.getElementById("commitmentDateSOUpdate").value =
              formattedDatesoOurCommitment;
            let Our_Commitment_DateDateSO = document.getElementById(
              "commitmentDateSOUpdate"
            ).value;
          }
          let ProductOptionso = "";
          window.productTypeContent_SO_Update.forEach((ProductType1SO) => {
            ProductOptionso += `<option value="${ProductType1SO.ID}">${ProductType1SO.Type_field}</option>`;
          });

          const itemContainerUpdateso = document.getElementById(
            "itemContainerUpdateSO"
          );
          let itemContainerUpdatehtmlso = "";
          window.itemDetailsso.forEach((itemso) => {
            itemContainerUpdatehtmlso += `
        <div class="itemrowupdateso" style="margin-bottom: 20px;">
        <div class="row" id="row1" style="display: flex; align-items: center; flex-wrap: wrap; font-weight: bold;">
                                <div style="flex: 1;">
                                  <label class="form-label" style="margin-bottom: 5px; display: block;">Product Type</label>
                                  <select id="productTypeSOUpdate" class="productTypeSOUpdate form-select">
                                    <option value="${itemso.Product_Type1.ID}">${itemso.Product_Type1.zc_display_value}</option>
                                    ${ProductOptionso}
                                  </select>
                                </div>
                                <div style="flex: 1;">
                                      <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                                      <input type="text" id="itemNameQTUpdate" value = "${itemso.Item}"
                                          class="item-name-updateso form-control form-control-sm"
                                          style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                  </div>
                                  <div style="flex: 1;">
                                      <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                                      <input type="number" id="itemqtysoUpdate" value = "${itemso.Qty}"
                                          class="item-code-updateso form-control form-control-sm"
                                          style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                  </div>
                                  <div style="flex: 2;">
                                      <label for="Description" class="form-label"
                                          style="margin-bottom: 5px; display: block;">Description</label>
                                      <textarea name="Description" id="itemDescriptionsoUpdate" rows="1"
                                          class="itemDescriptionsoUpdate form-control form-control-sm"
                                          style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; ">${itemso.Description}</textarea>
                                  </div>
                                  <div style="flex: 1;">
                                      <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                                      <select id="itemUnitsoUpdate" class="itemUnitsoUpdate form-select form-select-sm"
                                          style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                          <option>${itemso.Unit}</option>
                                          <option>Box</option>
                                          <option>Each</option>
                                          <option>Feet</option>
                                          <option>Sq Feet</option>
                                          <option>Sheet</option>
                                          <option>Pieces</option>
                                          <option>Units</option>
                                      </select>
                                  </div>
                                  <div style="flex: 1;">
                                      <label for="Cost" class="form-label" style="margin-bottom: 5px; display: block; font-size: medium;">Piece Cost ($)</label>
                                      <input type="number" id="pieceCostsoUpdate" class="pieceCostsoUpdate form-control form-control-sm"
                                          value = "${itemso.Piece_cost}"
                                          style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                  </div>
                                  <div style="flex: 1; ">
                                      <label for="Markup" class="form-label" style="margin-bottom: 5px; display: block;">Markup
                                          (%)</label>
                                      <input type="number" id="markupsoUpdate" class="markupsoUpdate form-control form-control-sm"
                                          value = "${itemso.Margin}"
                                          style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                  </div>
                              </div>
        </div>`;
          });
          itemContainerUpdateso.innerHTML = itemContainerUpdatehtmlso;
        };
        // Attach event listeners dynamically
        document.addEventListener("click", function (event) {
          const buttonso = event.target.closest(".edit-btnSO");
          if (buttonso) {
            const itemIdso = buttonso.getAttribute("data-idSO");
            window.MainRecordIDfor_ItemDetailsso = itemIdso;
            handleEditClickSO(itemIdso);
          }
        });
        // Call function to fetch data and populate table
        fetchSalesOrders();

        //fetch Design Order Reports
        const conn_name_DOReport = "crmwidgetconnection";
        const accountIdDataCRMDO =
          typeof window !== "undefined" && window.accountId
            ? window.accountId
            : "DEFAULT_ACCOUNT_ID";
        const criteriaDO = encodeURIComponent(
          `(CRM_Account_Name == "${accountIdDataCRMDO}")`
        );
        const apiUrl_DOReport = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/DO_For_CRM_widget_Update?criteria=${criteriaDO}`;
        const req_data_DOReport = {
          parameters: {},
          headers: {
            "Content-Type": "application/json",
          },
          method: "GET",
          url: apiUrl_DOReport,
          param_type: 1,
        };
        // Declare global arrays
        let globalItemsArrayDO = [];
        window.globalItemsArrayDO = globalItemsArrayDO;

        // Function to fetch and process DO data
        async function fetchDOReports() {
          try {
            const response = await ZOHO.CRM.CONNECTION.invoke(
              conn_name_DOReport,
              req_data_DOReport
            );
            if (
              response.code === "SUCCESS" &&
              response.details.statusMessage.data
            ) {
              const DOReport = response.details.statusMessage.data;
              //console.log("DO Report Data is:", DOReport);
              // Populate the table
              populateDesignOrderTable(DOReport);

              if (!Array.isArray(DOReport)) {
                console.error(
                  "DO Report data is not in array format:",
                  DOReport
                );
                return;
              }
              // Update global arrays
              globalItemsArrayDO = [...DOReport];
              // Ensure global accessibility
              window.globalItemsArray = globalItemsArray;
              // Fetch items **AFTER** Designorder are populated
            } else {
              console.error("API Response Error:", response);
            }
          } catch (error) {
            console.error("Error Fetching DO Data:", error);
          }
        }

        // Function to populate the table with Design Order data
        function populateDesignOrderTable(data) {
          globalItemsArrayDO = [...data];
          window.globalItemsArrayDO = globalItemsArrayDO;
          const tableBody = document.querySelector("#designOrderTable tbody");
          const totalDOCountSpan = document.querySelector("#totalDOCount");

          if (!tableBody) {
            console.error("Table body #designOrderTable tbody not found!");
            return;
          }

          // Clear existing table data
          tableBody.innerHTML = "";

          if (data.length === 0) {
            tableBody.innerHTML =
              "<tr><td colspan='7'>No records found</td></tr>";
            return;
          }

          data.forEach((order) => {
            const row = document.createElement("tr");
            const isDesignerAssigned =
              order.Status.toLowerCase() === "designer not assigned"; // âœ… Check if status is "Draft"
            //console.log("isDesignerAssigned", isDesignerAssigned);
            let itemIDDatado = order.ID;
            // âœ… Assign record ID dynamically
            window.MainRecordIDfor_ItemDetailsdo = itemIDDatado;
            // console.log(
            //   "window.MainRecordIDfor_ItemDetailsDO",
            //   window.MainRecordIDfor_ItemDetailsdo
            // );
            row.innerHTML = `
              <td>${order.Design_Order || "N/A"}</td>
              <td>${order.Customer_due_date || "N/A"}</td>
              <td>${order.DO_Name || "N/A"}</td>
              <td>${order.Order_Date || "N/A"}</td>
              <td class="status-celldo">${order.Status || "N/A"}</td>
              <td>${order.Assigned_Designer.zc_display_value || "N/A"}</td>
              <td>
                <div id="divIDItemDO" class="edit-btnDO"
                  data-bs-toggle="modal"
                  data-bs-target="#editModalDO"
                  data-idDO="${order.ID}"
                  data-Doname = "${order.DO_Name}"
                  data-postProductionUpdate = "${order.Post_production}"
                  data-noteUpdate = "${order.Notes}"
                  data-privateNoteUpdate = "${order.Private_Notes_widget}"
                  onclick="${
                    isDesignerAssigned
                      ? `handleEditClickDO('${order.ID}')`
                      : `handleViewClick('${order.ID}')`
                  }">
                  <i style="color:${
                    isDesignerAssigned ? "green" : "blue"
                  }" class="fa ${
              isDesignerAssigned ? "fa-edit" : "fa-eye"
            }"></i>
                </div>
              </td>
          `;
            //onclick="handleEditClickDO('${order.ID}')">
            //<i style="color:green" class="fa fa-edit"></i>
            tableBody.appendChild(row);

            // Apply background color based on status
            const statusCelldo = row.querySelector(".status-celldo");
            if (isDesignerAssigned) {
              statusCelldo.style.backgroundColor = "#6FC276"; // Soft green
              statusCelldo.style.color = "#000000"; // Dark gray text
            } else {
              statusCelldo.style.backgroundColor = "#e2e3e5"; // Light gray
              statusCelldo.style.color = "#000000"; // Dark gray text
            }
            //
          });
          // Update total count in the span
          totalDOCountSpan.textContent = ` ${data.length}`;
        }

        // // âœ… Fetch items AFTER setting window.MainRecordIDfor_ItemDetails Design order
        async function fetchItemDetailsdo() {
          if (!window.MainRecordIDfor_ItemDetailsdo) {
            console.warn("MainRecordIDfor_ItemDetailsdo is not set yet.");
            return;
          }
          const conn_name_GETitemsdo = "crmwidgetconnection";
          const recordIDforitemdo = window.MainRecordIDfor_ItemDetailsdo; // âœ… Use dynamically assigned value
          //console.log("Fetching items for record ID DO:", recordIDforitemdo);

          const apiUrl_getitemsdo = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/All_Designorder_Item_Details?criteria=(Design_Order==${recordIDforitemdo})`;

          const req_data_getitemsdo = {
            parameters: {},
            headers: {
              "Content-Type": "application/json",
            },
            method: "GET",
            url: apiUrl_getitemsdo,
            param_type: 1,
          };

          try {
            const response = await ZOHO.CRM.CONNECTION.invoke(
              conn_name_GETitemsdo,
              req_data_getitemsdo
            );

            if (
              response.code === "SUCCESS" &&
              response.details?.statusMessage?.data
            ) {
              window.itemDetailsdo = response.details.statusMessage.data;
              console.log(
                "âœ… Updated window.itemDetails DO:",
                window.itemDetailsdo
              );
            } else {
              console.warn(
                "No records found. Check the criteria:",
                response.details.statusMessage.message
              );
            }
          } catch (error) {
            console.error("Error fetching item details:", error);
          }
        }

        // Function to get item details by ID
        function getItemDetailsByIddo(itemIddo) {
          if (!window.itemDetailsdo || window.itemDetailsdo.length === 0) {
            console.error("Item details DO not loaded yet.");
            return null;
          }
          const orderDO = globalItemsArrayDO.find(
            (order) => order.ID === itemIddo
          );
          console.log(`Item Details for ID DO ${itemIddo}:`, orderDO);
          return orderDO;
        }

        // Function to handle edit button click
        window.handleEditClickDO = async function (itemIddo) {
          // Set global variable properly
          window.MainRecordIDfor_ItemDetailsdo = itemIddo;
          console.log("Clicked item ID DO:", itemIddo);
          // Wait for fetchItemDetails to complete
          await fetchItemDetailsdo();
          const itemdo = getItemDetailsByIddo(itemIddo);
          if (!itemdo) {
            console.error("Item details not found for ID: DO", itemIddo);
            return;
          }
          if (itemdo) {
            document.getElementById("donameUpdate").value =
              itemdo.DO_Name || "";
            document.getElementById("postProductionDOUpdate").value =
              itemdo.Post_production || "";
            document.getElementById("notesUpdateDO").value = itemdo.Notes || "";
            document.getElementById("privateNoteUpdateDO").value =
              itemdo.Private_Notes_widget || "";
            //
            function formatDateToYYYYMMDD(dateString) {
              // Define months mapping
              const months = {
                Jan: "01",
                Feb: "02",
                Mar: "03",
                Apr: "04",
                May: "05",
                Jun: "06",
                Jul: "07",
                Aug: "08",
                Sep: "09",
                Oct: "10",
                Nov: "11",
                Dec: "12",
              };
              // Split the input date (e.g., "25-Feb-2025")
              let parts = dateString.split("-");
              if (parts.length === 3) {
                let day = parts[0].padStart(2, "0");
                let month = months[parts[1]];
                let year = parts[2];

                if (month) {
                  return `${year}-${month}-${day}`;
                }
              }
              return ""; // Return empty if parsing fails
            }
            let dateValue = itemdo.Our_Commitment_Date || "";
            // Convert the date to "yyyy-MM-dd" format if necessary
            let formattedDate = dateValue
              ? formatDateToYYYYMMDD(dateValue)
              : "";
            // Assign the correctly formatted date to the input field
            document.getElementById("Our_Commitment_DateUpdateDO").value =
              formattedDate;
            let Our_Commitment_DateUpdateData = document.getElementById(
              "Our_Commitment_DateUpdateDO"
            ).value;
            //Customer_due_date
            let dateValue1 = itemdo.Customer_due_date || "";
            // Convert the date to "yyyy-MM-dd" format if necessary
            let formattedDate1 = dateValue1
              ? formatDateToYYYYMMDD(dateValue1)
              : "";
            document.getElementById("Customer_Due_DateUpdateDo").value =
              formattedDate1;
            let Customer_Due_DateUpdateDo1 = document.getElementById(
              "Customer_Due_DateUpdateDo"
            ).value;
            //
          } else {
            console.warn("No matching item found for ID:", itemIddo);
          }

          let ProductOptiondo = "";
          window.productTypeContent_DO_Update.forEach((ProductType1DO) => {
            ProductOptiondo += `<option value="${ProductType1DO.ID}">${ProductType1DO.Type_field}</option>`;
          });

          const itemContainerUpdatedo = document.getElementById(
            "itemContainerUpdateDO"
          );
          let itemContainerUpdatehtmldo = "";
          window.itemDetailsdo.forEach((itemdoProduct) => {
            //console.log("Item Detail for Update do:", itemdoProduct);
            itemContainerUpdatehtmldo += `
<div class="itemrowupdatedo" style="margin-bottom: 20px;">
<div class="row" id="row1" style="display: flex; align-items: center; flex-wrap: wrap; font-weight: bold;">
                        <div style="flex: 1;">
                          <label class="form-label" style="margin-bottom: 5px; display: block;">Product Type</label>
                          <select id="" class="productTypeDOUpdate form-select">
                            <option value="${itemdoProduct.Product_Type.ID}">${itemdoProduct.Product_Type.zc_display_value}</option>
                            ${ProductOptiondo}
                          </select>
                        </div>
                        <div style="flex: 1;">
                              <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                              <input type="text" id="" value = "${itemdoProduct.Item_Name}"
                                  class="item-name-updatedo form-control form-control-sm"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                          </div>
                          <div style="flex: 1;">
                              <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                              <input type="number" id="" value = "${itemdoProduct.Qty}"
                                  class="item-code-updatedo form-control form-control-sm"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                          </div>
                          <div style="flex: 2;">
                              <label for="Description" class="form-label"
                                  style="margin-bottom: 5px; display: block;">Description</label>
                              <textarea name="Description" id="" rows="1"
                                  class="itemDescriptionDOUpdate form-control form-control-sm"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; ">${itemdoProduct.Description}</textarea>
                          </div>
                          <div style="flex: 1;">
                              <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                              <select id="" class="itemUnitDOUpdate form-select form-select-sm"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                  <option>${itemdoProduct.Unit}</option>
                                  <option>Box</option>
                                  <option>Each</option>
                                  <option>Feet</option>
                                  <option>Sq Feet</option>
                                  <option>Sheet</option>
                                  <option>Pieces</option>
                                  <option>Units</option>
                              </select>
                          </div>
                      </div>
            </div>`;
          });
          itemContainerUpdatedo.innerHTML = itemContainerUpdatehtmldo;
          // Fetch correct item details dynamically
        };
        // Attach event listeners dynamically
        document.addEventListener("click", function (event) {
          const buttondo = event.target.closest(".edit-btnDO");
          if (buttondo) {
            const itemIddoID = buttondo.getAttribute("data-idDO");
            window.MainRecordIDfor_ItemDetailsdo = itemIddoID;
            handleEditClickDO(itemIddoID);
          }
        });
        // Call function to fetch and populate table
        fetchDOReports();

        // Fetch and display Estimate Data for SO
        const conn_name_GETQT = "crmwidgetconnection";
        const apiUrl_getqt = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/Estimate_2_0_Report`;
        const req_data_getqt = {
          parameters: {},
          headers: {
            "Content-Type": "application/json",
          },
          method: "GET",
          url: apiUrl_getqt,
          param_type: 1,
        };
        // Fetch Estimate data and initialize search functionality
        async function fetchEstimates() {
          await ZOHO.CRM.CONNECTION.invoke(
            conn_name_GETQT,
            req_data_getqt
          ).then(
            function (response) {
              //console.log("QT Response for DO search Rafi:", response);
              if (response.code === "SUCCESS") {
                const estimates = response.details.statusMessage.data;
                //console.log("Fetched Estimate Data:", estimates);
                // Populate Estimate List for Search Field and Dropdown for SO
                initializeEstimateSearchAndDropdown(estimates);
              }
            },
            function (errorResponse) {
              console.error("Error Fetching Estimates:", errorResponse);
            }
          );
        }
        // Initialize searchable input and dropdown for SO to GET QT

        function initializeEstimateSearchAndDropdown(estimates) {
          const searchInput = document.getElementById("estimateSearch");
          const dropdown = document.getElementById("estimateDropdown");
          // Clear previous data
          dropdown.innerHTML =
            '<option value="">Select an Estimate (Quote)</option>';
          // Populate dropdown with all Estimates (Quotes)
          estimates.forEach((estimate) => {
            const option = document.createElement("option");
            option.value = estimate.ID;
            option.textContent = estimate.Quote;
            dropdown.appendChild(option);
          });
          // Search input event
          searchInput.addEventListener("input", function () {
            const searchText = searchInput.value.toLowerCase();
            // Filter dropdown options
            dropdown.innerHTML =
              '<option value="">Select an Estimate (Quote)</option>';
            estimates
              .filter((estimate) =>
                estimate.Quote.toLowerCase().includes(searchText)
              )
              .forEach((estimate) => {
                const option = document.createElement("option");
                option.value = estimate.ID;
                option.textContent = estimate.Quote;
                dropdown.appendChild(option);
              });
          });
          // Store selected Estimate ID globally
          dropdown.addEventListener("change", function () {
            window.selectedEstimateID = dropdown.value;
            //console.log("Selected Estimate ID:", window.selectedEstimateID);
          });
        }
        // Initialize searchable input and dropdown for Do field to search QT
        // Call fetch function when page loads
        fetchEstimates();

        // Fetch and display Salesorder Data For DesignOrder
        const conn_name_GETSO = "crmwidgetconnection";
        const apiUrl_getso = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/All_Salesorder_List_view`;
        const req_data_getso = {
          parameters: {},
          headers: {
            "Content-Type": "application/json",
          },
          method: "GET",
          url: apiUrl_getso,
          param_type: 1,
        };

        // Fetch Salesorder data and initialize search functionality
        async function fetchSalesOrdersALLData() {
          await ZOHO.CRM.CONNECTION.invoke(
            conn_name_GETSO,
            req_data_getso
          ).then(
            function (response) {
              if (response.code === "SUCCESS") {
                const salesOrders = response.details.statusMessage.data;
                //console.log("Fetched Sales Orders:", salesOrders);
                // Populate Salesorder List for Search Field and Dropdown
                initializeSearchAndDropdown(salesOrders);
              }
            },
            function (errorResponse) {
              console.error("Error Fetching Sales Orders:", errorResponse);
            }
          );
        }
        // Initialize searchable input and dropdown
        function initializeSearchAndDropdown(salesOrders) {
          const searchInput = document.getElementById("salesOrderSearchDO");
          const dropdown = document.getElementById("salesOrderDropdownDO");
          // Clear previous data
          dropdown.innerHTML = '<option value="">Select a Salesorder</option>';
          // Populate dropdown with all Salesorders
          salesOrders.forEach((order) => {
            const option = document.createElement("option");
            option.value = order.ID;
            option.textContent = order.Salesorder;
            dropdown.appendChild(option);
          });

          // Search input event
          searchInput.addEventListener("input", function () {
            const searchText = searchInput.value.toLowerCase();

            // Filter dropdown options
            dropdown.innerHTML =
              '<option value="">Select a Salesorder</option>';
            salesOrders
              .filter((order) =>
                order.Salesorder.toLowerCase().includes(searchText)
              )
              .forEach((order) => {
                const option = document.createElement("option");
                option.value = order.ID;
                option.textContent = order.Salesorder;
                dropdown.appendChild(option);
              });
          });

          // Store selected Salesorder ID globally
          dropdown.addEventListener("change", function () {
            window.selectedSalesOrderID = dropdown.value;
            //console.log("Selected Salesorder ID:", window.selectedSalesOrderID);
          });
        }
        // Call fetch function when page loads
        fetchSalesOrdersALLData();

        // // Fetch and display Estimate Data for DO QT Field
        // const conn_name_GETQTDO = "crmwidgetconnection";
        // const apiUrl_getqtdo = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/QT_for_DO_field_widget`;
        // const req_data_getqtDO = {
        //   parameters: {},
        //   headers: {
        //     "Content-Type": "application/json",
        //   },
        //   method: "GET",
        //   url: apiUrl_getqtdo,
        //   param_type: 1,
        // };
        // // Fetch Estimate data and initialize search functionality
        // async function fetchEstimatesDO() {
        //   await ZOHO.CRM.CONNECTION.invoke(conn_name_GETQTDO, req_data_getqtDO).then(
        //     function (responseDO) {
        //       if (responseDO.code === "SUCCESS") {
        //         const estimatesDO = responseDO.details.statusMessage.data;
        //         console.log("Fetched QT Data for DO Field:", estimatesDO);

        //         // Populate Estimate List for Search Field and Dropdown
        //         initializeEstimateSearchAndDropdownDO(estimatesDO);
        //       }
        //     },
        //     function (errorResponseDO) {
        //       console.error("Error Fetching Estimates DO:", errorResponseDO);
        //     }
        //   );
        // }
        // // Initialize searchable input and dropdown for Do field to search QT
        // function initializeEstimateSearchAndDropdownDO(estimatesDO) {
        //   const searchInputDO = document.getElementById("estimateSearchDO");
        //   const dropdownDO = document.getElementById("estimateDropdownDO");

        //   // Clear previous data
        //   dropdownDO.innerHTML = '<option value="">Select an Estimate (Quote)</option>';

        //   // Populate dropdown with all Estimates (Quotes)
        //   estimatesDO.forEach(estimateDO => {
        //     const option = document.createElement("option");
        //     option.value = estimateDO.ID;
        //     option.textContent = estimateDO.Quote;
        //     dropdownDO.appendChild(option);
        //   });

        //   // Search input event
        //   searchInputDO.addEventListener("input", function () {
        //     const searchTextDO = searchInputDO.value.toLowerCase();

        //     // Filter dropdown options
        //     dropdownDO.innerHTML = '<option value="">Select an Estimate</option>';
        //     estimatesDO
        //       .filter(estimateDO => estimateDO.Quote.toLowerCase().includes(searchTextDO))
        //       .forEach(estimateDO => {
        //         const option = document.createElement("option");
        //         option.value = estimateDO.ID;
        //         option.textContent = estimateDO.Quote;
        //         dropdownDO.appendChild(option);
        //       });
        //   });

        //   // Store selected Estimate ID globally
        //   dropdownDO.addEventListener("change", function () {
        //     window.selectedEstimateIDDO = dropdownDO.value;
        //     console.log("Selected Estimate ID DO:", window.selectedEstimateIDDO);
        //   });
        // }
        // // Call fetch function when page loads
        // fetchEstimatesDO();

        // Fetch and display Design Order Data
        const conn_name_GETDesign = "crmwidgetconnection";
        const apiUrl_getdesign = `https://www.zohoapis.com/creator/v2.1/data/sst1source/source-erp/report/All_Design_Orders`;
        const req_data_getdesign = {
          parameters: {},
          headers: {
            "Content-Type": "application/json",
          },
          method: "GET",
          url: apiUrl_getdesign,
          param_type: 1,
        };

        // Fetch Design Order data and initialize search functionality
        async function fetchDesignOrdersALLData() {
          await ZOHO.CRM.CONNECTION.invoke(
            conn_name_GETDesign,
            req_data_getdesign
          ).then(
            function (response) {
              if (response.code === "SUCCESS") {
                const designOrders = response.details.statusMessage.data;
                //console.log("Fetched Design Orders:", designOrders);

                // Populate Design Order List for Search Field and Dropdown
                initializeDesignSearchAndDropdown(designOrders);
              }
            },
            function (errorResponse) {
              console.error("Error Fetching Design Orders:", errorResponse);
            }
          );
        }

        // Initialize searchable input and dropdown for Design Orders
        function initializeDesignSearchAndDropdown(designOrders) {
          const searchInput = document.getElementById("designOrderSearch");
          const dropdown = document.getElementById("designOrderDropdown");

          // Clear previous data
          dropdown.innerHTML =
            '<option value="">Select a Design Order</option>';

          // Populate dropdown with all Design Orders
          designOrders.forEach((order) => {
            const option = document.createElement("option");
            option.value = order.ID;
            option.textContent = order.Design_Order; // Use Design_Order for dropdown label
            dropdown.appendChild(option);
          });

          // Search input event
          searchInput.addEventListener("input", function () {
            const searchText = searchInput.value.toLowerCase();

            // Filter dropdown options
            dropdown.innerHTML =
              '<option value="">Select a Design Order</option>';
            designOrders
              .filter((order) =>
                order.Design_Order.toLowerCase().includes(searchText)
              )
              .forEach((order) => {
                const option = document.createElement("option");
                option.value = order.ID;
                option.textContent = order.Design_Order;
                dropdown.appendChild(option);
              });
          });

          // Store selected Design Order ID globally
          dropdown.addEventListener("change", function () {
            window.selectedDesignOrderID = dropdown.value;
          });
        }

        // Call fetch function when page loads
        fetchDesignOrdersALLData();
      });

      ZOHO.embeddedApp.init();
    </script>
  </head>
  <body>
    <script src="js/estimateCreate.js"></script>
    <script src="js/SalesOrderCreate.js"></script>
    <script src="js/DesignOrderCreate.js"></script>
    <script src="js/estimateUpdate.js"></script>
    <script src="js/salesorderUpdate.js"></script>
    <script src="js/DesignOrderUpdate.js"></script>

    <div class="container mt-5">
      <!-- Main Tabs -->
      <ul
        class="nav nav-tabs justify-content-left"
        id="mainTabs"
        role="tablist"
      >
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="estimate-tab"
            data-bs-toggle="tab"
            data-bs-target="#estimate"
            type="button"
            role="tab"
            aria-controls="estimate"
            aria-selected="true"
          >
            Estimate<span class="countsDataColor" id="estimateCount"
              >&nbsp;0</span
            >
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="salesorder-tab"
            data-bs-toggle="tab"
            data-bs-target="#salesorder"
            type="button"
            role="tab"
            aria-controls="salesorder"
            aria-selected="false"
          >
            Sales Order<span class="countsDataColor" id="totalSalesOrderCount"
              >&nbsp;0</span
            >
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="Designorder-tab"
            data-bs-toggle="tab"
            data-bs-target="#Designorder"
            type="button"
            role="tab"
            aria-controls="Designorder"
            aria-selected="false"
          >
            Design Order<span class="countsDataColor" id="totalDOCount"
              >&nbsp;0</span
            >
          </button>
        </li>
      </ul>
      <div class="tab-content mt-4" id="mainTabContent">
        <!-- Estimate Tab -->
        <div
          class="tab-pane fade show active"
          id="estimate"
          role="tabpanel"
          aria-labelledby="estimate-tab"
        >
          <div
            class="tab-pane fade show active"
            id="estimate-create"
            role="tabpanel"
            aria-labelledby="estimate-create-tab"
          >
            <div class="header">
              <h1 id="listViewHeader">Estimates List View</h1>
              <button class="add-button" onclick="toggleForm(true)">
                + Create Estimate
              </button>
            </div>
          </div>
          <div id="listView">
            <table id="estimateTable">
              <thead>
                <tr>
                  <th>Quote ID</th>
                  <th>Date</th>
                  <th>Quote Name</th>
                  <th>Quote Status</th>
                  <th>Salesperson</th>
                  <th>Edit/View</th>
                </tr>
              </thead>
              <tbody>
                <!-- Bootstrap Modal (Extra Large) QT -->
                <div
                  class="modal fade"
                  id="editModal"
                  tabindex="-1"
                  aria-labelledby="editModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabelQT"></h5>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        <form id="editForm">
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="quoteName" class="form-label"
                                >Quote Name</label
                              >
                              <input
                                type="text"
                                class="form-control"
                                id="quoteNameUpdate"
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Post Production</label
                              >
                              <select
                                id="PostProductionUpdate"
                                class="form-select"
                                title="Post Production"
                              >
                                <option>Select an option</option>
                                <option>We Deliver (Our Vehicle)</option>
                                <option>We Deliver (Rented Truck)</option>
                                <option>Customer Pickup</option>
                                <option>Dropship</option>
                                <option>Send UPS/Fedex (Our Account)</option>
                                <option>
                                  Send UPS/Fedex (Customer Account)
                                </option>
                                <option>Freight Delivery</option>
                                <option>Install</option>
                                <option>Unknown</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Permit Needed?</label
                              >
                              <select
                                id="permitNeededQTUpdate"
                                class="form-select"
                                title="Permit Needed?"
                              >
                                <option selected>Select Permit</option>
                                <option>Yes</option>
                                <option>No</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Site Survey Needed</label
                              >
                              <select
                                id="siteSurveyQTUpdate"
                                class="form-select"
                                title="Site Survey Needed"
                              >
                                <option selected>Select Site Survey</option>
                                <option>Yes</option>
                                <option>No</option>
                              </select>
                            </div>
                          </div>
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="leadTime" class="form-label"
                                >Lead Time From Approval(BD)</label
                              >
                              <input
                                type="number"
                                id="leadTimeQTUpadate"
                                class="form-control"
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Location Name</label
                              >
                              <select
                                id="locationnameQTUpdate"
                                class="form-select"
                                title=""
                              >
                                <option selected>Select Location</option>
                              </select>
                            </div>
                          </div>
                          <!-- Below is item details inside modal for update QT -->
                          <div
                            style="
                              border: 1px solid #ddd;
                              padding: 20px;
                              border-radius: 5px;
                            "
                          >
                            <h5
                              style="
                                margin-bottom: 20px;
                                font-size: 18px;
                                font-weight: bold;
                              "
                            >
                              Item Details
                            </h5>
                            <div id="itemContainerUpdate"></div>
                            <div
                              style="margin-top: 20px; text-align: left"
                            ></div>
                            <!--  -->
                            <div class="container">
                              <!-- Table Header -->
                              <!-- Container for dynamic rows -->
                              <div id="itemsContainer" class="mt-2">
                                <!-- Dynamic item rows will be added here -->
                              </div>
                              <button
                                type="button"
                                class="btn btn-primary mt-3"
                                id="addItem"
                              >
                                + Add Item
                              </button>
                            </div>
                            <!-- jQuery Script to Add/Remove Rows -->
                            <script>
                              $(document).ready(function () {
                                $("#addItem").click(function () {
                                  //2 - add items in for item row dinamically
                                  // let productTypeOptionModalQTUpdate;
                                  // window.productTypeContentItemRowCreate.forEach(
                                  //   (productTypeDataUpdatQT) => {
                                  //     productTypeOptionModalQTUpdate += `<option value=${productTypeDataUpdatQT.ID}>${productTypeDataUpdatQT.Type_field}</option>`;
                                  //   }
                                  // ); //end of forEach
                                  $("#itemsContainer").append(`
                          <!-- Row of Fields -->
                          <div class="row item-row itemrowupdate" id="" style="display: flex; align-items: center; flex-wrap: wrap; font-weight: bold;">
                            <div style="flex: 1; min-width: 120px;">
                                      <label class="form-label">Product Type</label>
                                    <select id="productTypeAddRowQT" class="productTypeAddRowQT form-select">
                                        <option>Select Type</option>
                                    </select>
                              </div> 
                              <div style="flex: 1; min-width: 120px;">
                                  <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                                  <input type="text" id="item-nameAddRowQT" placeholder="Item"
                                      class="item-name-update item-nameAddRowQT form-control form-control-sm"
                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                              </div>
                              <div style="flex: 1; min-width: 80px;">
                                  <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                                  <input type="number" id="itemqtyAddRowQT" placeholder="Qty"
                                      class="item-codeAddRowQT form-control form-control-sm"
                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                              </div>

                            <div style="flex: 2; min-width: 200px;">
                                    <label for="Description" class="form-label"
                                        style="margin-bottom: 5px; display: block;">Description</label>
                                    <textarea name="Description" id="itemdescAddRowQT" rows="1"
                                        class="Description_AddRowQT form-control form-control-sm" placeholder="Description"
                                        style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; "></textarea>
                                </div>

                              <div style="flex: 1; min-width: 120px;">
                                  <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                                  <select id="itemUnitAddRowQT" class="itemUnitAddRowQT form-select form-select-sm"
                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                      <option>Box</option>
                                      <option>Each</option>
                                      <option>Feet</option>
                                      <option>Sq Feet</option>
                                      <option>Sheet</option>
                                      <option>Pieces</option>
                                      <option>Units</option>
                                  </select>
                              </div>
                              <div style="flex: 1; min-width: 120px;">
                                  <label for="Cost" class="form-label" style="margin-bottom: 5px; display: block; font-size: medium;">Piece Cost
                                      ($)</label>
                                  <input type="number" id="priceCostAddRowQT" class="priceCostAddRowQT form-control form-control-sm"
                                      placeholder="Piece Cost ($)"
                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                              </div>
                              <div style="flex: 1; min-width: 120px;">
                                  <label for="Markup" class="form-label" style="margin-bottom: 5px; display: block;">Markup
                                      (%)</label>
                                  <input type="number" id="markupAddRowQT" class="markupAddRowQT form-control form-control-sm"
                                      placeholder="Markup (%)"
                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                              </div>
                          </div>
                          <hr style="margin-bottom: 8px; border: none;color: transparent; background-color: transparent;">
                          `);
                                });
                                // $(document).on("click", ".remove-item", function () {
                                //   $(this).closest(".item-row").remove();
                                // });
                              });
                            </script>

                            <!-- above script is to add a new row into QT Update -->
                          </div>
                          <!--  -->
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="notes" class="form-label"
                                >Notes</label
                              >
                              <textarea
                                id="notesUpdate"
                                class="form-control"
                                rows="4"
                                placeholder=""
                              ></textarea>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Private Notes</label
                              >
                              <textarea
                                id="privateNoteUpdate"
                                class="form-control"
                                rows="4"
                                placeholder="Enter private notes here"
                              ></textarea>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="col-sm-6 col-form-label"
                                >Down Payment (%)</label
                              >
                              <input
                                type="text"
                                id="downPaymentPercentQTUpdate"
                                class="form-control"
                                placeholder="0%"
                              />
                              <span style="color: darkred"
                                >Put only number not %</span
                              >
                            </div>
                          </div>
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Close
                        </button>
                        <button
                          type="button"
                          class="btn btn-primary"
                          id="QTupdateChanges"
                        >
                          Save changes
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <script>
                  document.addEventListener("DOMContentLoaded", () => {
                    const editModal = document.getElementById("editModal");
                    const modalTitle =
                      document.getElementById("editModalLabelQT");

                    editModal.addEventListener("show.bs.modal", (event) => {
                      const button = event.relatedTarget; // Button that triggered the modal
                      const statusCell = button
                        .closest("tr")
                        .querySelector(".status-cellQT")
                        .textContent.trim()
                        .toLowerCase();

                      // Set modal title based on status
                      modalTitle.textContent =
                        statusCell === "draft" ? "Edit Quote" : "View Quote";
                    });
                  });
                </script>
              </tbody>
            </table>
          </div>
        </div>
        <div style="font-weight: bold" class="form-section" id="formSection">
          <div class="header-with-close">
            <h4>Create New Estimate</h4>
            <button class="close-button" onclick="toggleForm(false)">X</button>
          </div>
          <br />
          <div id="createEstimateForm1">
            <div class="row mb-3">
              <div class="col-md-3">
                <label style="font-weight: bold" for="" class="form-label"
                  >Quote Date</label
                >
                <input
                  style="margin: 3px; padding: 7px"
                  type="text"
                  id="dateField"
                  placeholder="Date"
                  class="form-control"
                  readonly
                />
                <script>
                  // Function to get the current date
                  function displayCurrentDate() {
                    const today = new Date(); // Get the current date and time
                    const year = today.getFullYear();
                    const month = String(today.getMonth() + 1).padStart(2, "0"); // Months are 0-based
                    const day = String(today.getDate()).padStart(2, "0");
                    // Format the date as YYYY-MM-DD
                    const formattedDate = `${year}-${month}-${day}`;
                    // Display the date in the input field
                    document.getElementById("dateField").value = formattedDate;
                  }
                  // Call the function to set the date on page load
                  displayCurrentDate();
                </script>
              </div>
              <div class="col-md-3">
                <label for="quoteName" class="form-label">Quote Name</label
                ><span class="requiredFields"> *</span>
                <input
                  style="padding: 7px"
                  type="text"
                  id="quoteNameQT"
                  class="form-control"
                  placeholder="Quote Name"
                  required
                />
              </div>
              <div class="col-md-3">
                <label for="taxRate" class="form-label">Tax Rate</label
                ><span class="requiredFields"> *</span>
                <select
                  style="padding: 7px"
                  id="taxRateQT"
                  class="form-select"
                  title="tax"
                  required
                >
                  <option selected>Select</option>
                  <option value="0%">0%</option>
                  <option value="6%">6%</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Salesperson</label>
                <select
                  style="margin: 3px; padding: 7px"
                  id="salespersonSelect"
                  name=""
                  title="s"
                  class="form-select"
                >
                  <option>Select Salesperson</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label">CRM Account Name</label
                ><span class="requiredFields"> *</span>
                <input
                  style="padding: 7px"
                  type="text"
                  placeholder="CRM Account Name"
                  id="accountNameQT"
                  class="form-control"
                  readonly
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">CRM Contact Name</label>
                <select
                  style="margin: 3px; padding: 7px"
                  id="contactSelectField"
                  class="form-select"
                  title="Contact name"
                >
                  <option value="" selected>Select a contact</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="locationName" class="form-label"
                  >Location Name</label
                >
                <select
                  style="margin: 3px; padding: 7px"
                  id="addressSelectField"
                  class="form-select"
                  title="Location Name"
                >
                  <option value="" selected>Select</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="vendorNumber" class="form-label"
                  >Vendor Number</label
                >
                <input
                  style="margin: 3px; padding: 7px"
                  type="text"
                  id="vendorNumberQT"
                  class="form-control"
                  placeholder="vendor Number"
                  readonly
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label">Post Production</label
                ><span class="requiredFields"> *</span>
                <select
                  style="padding: 7px"
                  id="postProductionQT"
                  class="form-select"
                  title="Post Production"
                  required
                >
                  <option selected>Select Post Production</option>
                  <option>We Deliver (Our Vehicle)</option>
                  <option>We Deliver (Rented Truck)</option>
                  <option>Customer Pickup</option>
                  <option>Dropship</option>
                  <option>Send UPS/Fedex (Our Account)</option>
                  <option>Send UPS/Fedex (Customer Account)</option>
                  <option>Freight Delivery</option>
                  <option>Install</option>
                  <option>Unknown</option>
                </select>
              </div>
              <!-- Internal Approver Dropdown -->
              <div class="col-md-3">
                <label for="" class="form-label">Internal Approver:</label>
                <span class="requiredFields"> *</span>
                <select
                  style="padding: 7px"
                  id="internalApprover"
                  class="form-select"
                  name="internalApprover"
                  title="Internal Approver"
                >
                  <option value="">Select Internal Approver</option>
                  <option value="Yes">Yes</option>
                  <option value="No">No</option>
                </select>
              </div>
              <!-- Conditional Approver Data -->
              <div id="approverFieldQT" style="display: none" class="col-md-3">
                <label for="approverQT" class="form-label">Approver:</label>
                <span class="requiredFields"> *</span>
                <select
                  style="padding: 7px"
                  id="approverQT"
                  class="form-select"
                  name="approverQT"
                  title="Approver"
                >
                  <option value="">Select Approver</option>
                </select>
              </div>
              <!--  -->
              <script>
                // Event listener for Internal Approver dropdown
                document
                  .getElementById("internalApprover")
                  .addEventListener("change", function () {
                    const approverDataField =
                      document.getElementById("approverFieldQT");

                    if (this.value === "Yes") {
                      window.internalApprover = "Yes"; // Set global variable
                      approverDataField.style.display = "block"; // Show approver field
                    } else {
                      window.internalApprover = "No"; // Set global variable
                      approverDataField.style.display = "none"; // Hide approver field
                    }
                  });
              </script>
              <!--  -->
              <div class="row mb-3">
                <div class="col-md-3">
                  <label
                    style="margin-top: 10px"
                    for="leadTime"
                    class="form-label"
                    >Lead Time From Approval (Business Days)</label
                  >
                  <input
                    style="padding: 7px"
                    type="number"
                    id="leadTime"
                    class="form-control"
                  />
                </div>
              </div>
              <br />
            </div>
            <!-- Item Details QT -->
            <div
              style="border: 1px solid #ddd; padding: 20px; border-radius: 5px"
            >
              <h5
                style="margin-bottom: 20px; font-size: 18px; font-weight: bold"
              >
                Item Details
              </h5>
              <div id="itemContainer">
                <div class="item-row" style="margin-bottom: 20px">
                  <div
                    class="row"
                    id="row1"
                    style="
                      display: flex;
                      align-items: center;
                      flex-wrap: wrap;
                      font-weight: bold;
                    "
                  >
                    <div
                      onclick="removeRow(this)"
                      style="width: 10px; margin-top: 25px"
                    >
                      <span style="color: red; width: 10px; height: 10px"
                        ><i class="fa fa-x hoverCSS"></i
                      ></span>
                    </div>
                    <div style="flex: 1">
                      <label
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Product Type</label
                      >
                      <select
                        id="productTypeQT"
                        class="productTypeQT form-select"
                      >
                        <option>Select Type</option>
                      </select>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Item"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Item</label
                      >
                      <input
                        type="text"
                        id="itemNameQT"
                        placeholder="Item"
                        class="item-name form-control form-control-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Qty"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Qty</label
                      >
                      <input
                        type="number"
                        id="itemqtyQT"
                        placeholder="Qty"
                        class="item-code form-control form-control-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 2">
                      <label
                        for="Description"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Description</label
                      >
                      <textarea
                        name="Description"
                        id="itemdescT"
                        rows="1"
                        class="Description-QT form-control form-control-sm"
                        placeholder="Description"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      ></textarea>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Unit"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Unit</label
                      >
                      <select
                        id="itemUnitQT"
                        class="itemUnitQT form-select form-select-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      >
                        <option>Box</option>
                        <option>Each</option>
                        <option>Feet</option>
                        <option>Sq Feet</option>
                        <option>Sheet</option>
                        <option>Pieces</option>
                        <option>Units</option>
                      </select>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Cost"
                        class="form-label"
                        style="
                          margin-bottom: 5px;
                          display: block;
                          font-size: medium;
                        "
                        >Piece Cost ($)</label
                      >
                      <input
                        type="number"
                        id="priceCostQT"
                        class="priceCostQT form-control form-control-sm"
                        placeholder="Piece Cost ($)"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Markup"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Markup (%)</label
                      >
                      <input
                        type="number"
                        id="markupQT"
                        class="markupQT form-control form-control-sm"
                        placeholder="Markup (%)"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                  </div>
                </div>
              </div>
              <div style="margin-top: 20px; text-align: left">
                <button
                  onclick="addRow()"
                  class="btn btn-primary btn-sm"
                  style="font-size: 14px"
                >
                  + Add Item
                </button>
              </div>
            </div>
            <!--  -->
            <br />
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="notes" class="form-label">Notes</label>
                <textarea
                  id="notesQT"
                  class="form-control"
                  rows="4"
                  placeholder="Enter notes here"
                ></textarea>
              </div>
              <div class="col-md-3">
                <label for="privateNotes" class="form-label"
                  >Private Notes</label
                >
                <textarea
                  id="privateNotesQT"
                  class="form-control"
                  rows="4"
                  placeholder="Enter private notes here"
                ></textarea>
              </div>
              <div class="col-md-3"></div>
              <div class="col-md-3">
                <label
                  for="downPaymentPercent"
                  class="col-sm-6 col-form-label"
                  style="font-size: medium"
                  >Down Payment (%)</label
                >
                <input
                  type="text"
                  id="downPaymentPercentQT"
                  class="form-control"
                  placeholder="0%"
                />
                <span style="color: darkred">Put only number not %</span>
              </div>
            </div>

            <h4 class="mt-4">Address Details</h4>
            <div class="row">
              <!-- Billing Details -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="billingName" class="form-label"
                    >Billing Name:</label
                  >
                  <input
                    type="text"
                    id="billingNameQT"
                    class="form-control"
                    placeholder="Enter Billing Name"
                    readonly
                  />
                </div>
                <div class="mb-3">
                  <label for="billTo" class="form-label">Bill To:</label>
                  <input
                    type="text"
                    id="billingStreet"
                    class="form-control"
                    placeholder="Address Line 1"
                    readonly
                  />
                  <input
                    type="text"
                    id=""
                    class="form-control"
                    placeholder="Address Line 2"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingCity"
                    class="form-control"
                    placeholder="City"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingState"
                    class="form-control"
                    placeholder="State"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingCode"
                    class="form-control"
                    placeholder="Zip Code"
                    readonly
                  />
                </div>
              </div>
              <!-- Shipping Details -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="shippingName" class="form-label"
                    >Shipping Name:</label
                  >
                  <input
                    type="text"
                    id="shippingNameQT"
                    class="form-control"
                    placeholder="Enter Shipping Name"
                    readonly
                  />
                </div>
                <div class="mb-3">
                  <label for="shipTo" class="form-label">Ship To:</label>
                  <input
                    type="text"
                    id="shippingStreet"
                    class="form-control"
                    placeholder="Address Line 1"
                    readonly
                  />
                  <input
                    type="text"
                    id="Address_line2_CRMQT"
                    class="form-control"
                    placeholder="Address Line 2"
                    readonly
                  />
                  <input
                    type="text"
                    id="shippingCity"
                    class="form-control"
                    placeholder="City"
                    readonly
                  />
                  <input
                    type="text"
                    id="shippingState"
                    class="form-control"
                    placeholder="State"
                    readonly
                  />
                  <input
                    type="text"
                    id="shippingCode"
                    class="form-control"
                    placeholder="Zip Code"
                    readonly
                  />
                </div>
                <div class="mb-3">
                  <label for="" class="form-label">Phone</label>
                  <input
                    type="text"
                    id="phoneQT"
                    class="form-control"
                    placeholder="Phone"
                    readonly
                  />
                </div>
                <!-- <div class="mb-3">
                  <label for="description" class="form-label" >Description</label>
                  <textarea style="border: none;" id="descriptionAddressQT" class="form-control-sm" rows="3"
                     placeholder="Enter description here" readonly></textarea>
                </div> -->
              </div>
            </div>
            <!-- Reference URL -->
            <h4 class="mt-4">Reference URL</h4>
            <div class="url-fields row">
              <div class="col-md-4">
                <input
                  id="urlEs1"
                  type="url"
                  class="form-control"
                  placeholder="URL 1"
                />
              </div>
              <div class="col-md-4">
                <input
                  id="urlEs2"
                  type="url"
                  class="form-control"
                  placeholder="URL 2"
                />
              </div>
              <div class="col-md-4">
                <input
                  id="urlEs3"
                  type="url"
                  class="form-control"
                  placeholder="URL 3"
                />
              </div>
            </div>
            <!--  -->
            <div class="row mb-3">
              <div class="col-md-6">
                <h4 class="mt-4">Customer Attachments</h4>

                <div id="attachments-container">
                  <label for="" class="form-label">File Upload</label>
                  <input
                    type="file"
                    multiple
                    id="fileInput22"
                    class="form-control"
                    title="file"
                  />
                </div>
                <p style="color: #007bff; margin-top: 5px">
                  You can select multiple files.
                </p>
              </div>
              <div class="col-md-6">
                <h4 class="mt-4">Private Attachments</h4>
                <div id="attachments-container">
                  <label for="" class="form-label">File Upload</label>
                  <input
                    type="file"
                    multiple
                    id="fileInput"
                    class="form-control"
                    title="file"
                  />
                </div>
                <p style="color: #007bff; margin-top: 5px">
                  You can select multiple files.
                </p>
              </div>
            </div>
            <!--  -->
            <br />
            <p
              id="errorMessageEs"
              style="font-size: 13px; color: red; display: none"
            >
              (*) Fields are required!
            </p>
            <div class="form-buttons">
              <button type="button" class="submit-button" id="estimatebtn">
                Submit
              </button>
              <button
                type="button"
                class="cancel-button"
                onclick="toggleForm(false)"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
        <!-- Sales Order Tab -->
        <div
          class="tab-pane fade"
          id="salesorder"
          role="tabpanel"
          aria-labelledby="salesorder-tab"
        >
          <div
            class="tab-pane fade show"
            id="salesorder-create"
            role="tabpanel"
            aria-labelledby="salesorder-create-tab"
          >
            <div class="headerso">
              <h1 id="listViewHeaderso">Sales Order List View</h1>
              <button class="addbuttonso" onclick="toggleFormso(true)">
                + Create Salesorder
              </button>
            </div>
          </div>
          <div id="listViewso">
            <table id="salesOrderTable">
              <thead>
                <tr>
                  <th>Sales Order ID</th>
                  <th>Customer Due Date</th>
                  <th>SO Name</th>
                  <th>Sales Order Status</th>
                  <th>Post Production</th>
                  <th>Edit/View</th>
                </tr>
              </thead>
              <tbody>
                <!-- Bootstrap Modal (Extra Large) For SO update-->
                <div
                  class="modal fade"
                  id="editModalSO"
                  tabindex="-1"
                  aria-labelledby="editModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabelSO"></h5>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        <form id="editFormSO">
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="sonameUpdate" class="form-label"
                                >SO Name</label
                              >
                              <input
                                type="text"
                                class="form-control"
                                id="sonameUpdate"
                              />
                            </div>

                            <div class="col-md-3">
                              <label for="leadTime" class="form-label"
                                >Lead Time From Approval(BD)</label
                              >
                              <input
                                type="number"
                                id="leadTimeUpadateSO"
                                class="form-control"
                              />
                            </div>

                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Permit Needed?</label
                              >
                              <select
                                id="permitNeededUpdateSO"
                                class="form-select"
                                title="Permit Needed?"
                              >
                                <option selected>Select Permit</option>
                                <option>Yes</option>
                                <option>No</option>
                              </select>
                            </div>

                            <div class="col-md-3">
                              <label for="taxRate" class="form-label"
                                >Tax Rate</label
                              >
                              <select
                                id="taxRateUpdateSO"
                                class="form-select"
                                title="tax"
                              >
                                <option selected>Select</option>
                                <option value="0%">0%</option>
                                <option value="6%">6%</option>
                              </select>
                            </div>
                          </div>

                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Is Design Proof Needed?</label
                              >
                              <select
                                id="designProofUpdateSO"
                                class="form-select"
                                title=""
                              >
                                <option selected>Select Design Proof</option>
                                <option>Yes</option>
                                <option>No</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Vendor Input Need?</label
                              >
                              <select
                                id="vendorInputNeededUpdateSO"
                                class="form-select"
                                title="Site Survey Needed"
                              >
                                <option selected>
                                  Select Vendor Input Needed
                                </option>
                                <option>Yes</option>
                                <option>No</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Site Survey Needed</label
                              >
                              <select
                                id="siteSurveyUpdateSO"
                                class="form-select"
                                title="Site Survey Needed"
                              >
                                <option selected>Select Site Survey</option>
                                <option>Yes</option>
                                <option>No</option>
                              </select>
                            </div>
                          </div>
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <!-- Post Production Dropdown -->
                              <label
                                for="Post_Production"
                                class="form-label"
                                style="padding: 7px; display: block"
                                >Post Production</label
                              >
                              <select
                                id="PostProductionUpdateSO"
                                style="padding: 7px"
                                class="form-select"
                                title="Post Production"
                              >
                                <option value="">Select Post Production</option>
                                <option value="We Deliver (Our Vehicle)">
                                  We Deliver (Our Vehicle)
                                </option>
                                <option value="deliverRentedTruck_SOupdate">
                                  We Deliver (Rented Truck)
                                </option>
                                <option value="customerPickup_SOupdate">
                                  Customer Pickup
                                </option>
                                <option value="dropship_SOupdate">
                                  Dropship
                                </option>
                                <option value="upsFedexOurAccount_SOupdate">
                                  Send UPS/Fedex (Our Account)
                                </option>
                                <option
                                  value="upsFedexCustomerAccount_SOupdate"
                                >
                                  Send UPS/Fedex (Customer Account)
                                </option>
                                <option value="freightDelivery_SOupdate">
                                  Freight Delivery
                                </option>
                                <option value="install_SOupdate">
                                  Install
                                </option>
                                <option value="unknown_SOupdate">
                                  Unknown
                                </option>
                              </select>
                            </div>
                          </div>
                          <!-- Field Groups -->
                          <!-- deliverOurVehicle_SOupdate -->
                          <div
                            id="WeDeliver_Our_Vehicle_SOupdate"
                            class="field-groupso"
                          >
                            <label for="deliveryAddress" class="form-label"
                              >Delivery Address</label
                            >
                            <br />
                            <div class="row mb-3">
                              <div class="col-md-3">
                                <label
                                  for="addressLine1"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Address Line 1</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DOV_addressLine1update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="addressLine2"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Address Line 2</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DOV_addressLine2update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="city"
                                  class="form-label"
                                  style="margin: 5px"
                                  >City</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DOV_cityupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="state"
                                  class="form-label"
                                  style="margin: 5px"
                                  >State</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DOV_stateupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <div class="row mb-3">
                              <div class="col-md-3">
                                <label
                                  for="zipCode"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Zip Code</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DOV_zipCodeupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="deliveryDate"
                                  class="form-label mt-2"
                                  style="margin: 5px"
                                  >Desired Delivery Date</label
                                >
                                <input
                                  type="date"
                                  id="SO_PO_DOV_deliveryDateupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="deliverRentedTruck_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px"
                          >
                            <div class="row md-3">
                              <span>Delivery Address</span>
                              <div class="col-md-3">
                                <label
                                  for="addressLine1"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Address Line 1</label
                                >
                                <input
                                  type="text"
                                  id="aSO_PO_DRT_ddressLine1update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="addressLine2"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Address Line 2</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DRT_addressLine2update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="city"
                                  class="form-label"
                                  style="margin: 5px"
                                  >City</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DRT_cityupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="state"
                                  class="form-label"
                                  style="margin: 5px"
                                  >State</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DRT_stateupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <div class="row mb-3">
                              <div class="col-md-3">
                                <label
                                  for="zipCode"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Zip Code</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DRT_zipCodeupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="vehicleNumber"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Vehicle Number</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DRT_vehicleNumberupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="rentedDeliveryDate"
                                  class="form-label mt-2"
                                  style="margin: 5px"
                                  >Desired Delivery Date</label
                                >
                                <input
                                  type="date"
                                  id="SO_PO_DRT_rentedDeliveryDateupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3"></div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="customerPickup_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px"
                          >
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for="knowWhoIsPickingUp"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Do We Know Who is Picking Up?</label
                                >
                                <select
                                  id="SO_PO_CP_knowWhoIsPickingUpupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" style="margin: 5px">
                                    Select an option
                                  </option>
                                  <option value="yes">Yes</option>
                                  <option value="no">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="knowWhenPickup"
                                  class="form-label mt-2"
                                  style="font-size: small"
                                  >Do We Know When Will Customer Pickup?</label
                                >
                                <select
                                  id="SO_PO_CP_knowWhenPickupupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" style="margin: 5px">
                                    Select an option
                                  </option>
                                  <option value="yes">Yes</option>
                                  <option value="no">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="pickupName"
                                  class="form-label mt-2"
                                  style="margin: 5px"
                                  >Name</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_CP_pickupNameupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="pickupDate"
                                  class="form-label mt-2"
                                  style="margin: 5px"
                                  >Pickup Date</label
                                >
                                <input
                                  type="date"
                                  id="SO_PO_CP_pickupDateupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="dropship_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px"
                          >
                            <div class="row md-3">
                              <span>Ship-To Address</span>
                              <div class="col-md-3">
                                <label
                                  for="addressLine1"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Address Line 1</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DS_addressLine1update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="addressLine2"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Address Line 2</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DS_addressLine2update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="city"
                                  class="form-label"
                                  style="margin: 5px"
                                  >City</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DS_cityupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="state"
                                  class="form-label"
                                  style="margin: 5px"
                                  >State</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DS_stateupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for="zipCode"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Zip Code</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_DS_zipCodeupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="shipFrom"
                                  class="form-label mt-2"
                                  style="margin: 5px"
                                  >Where Will it Ship From?</label
                                >
                                <select
                                  class="form-select"
                                  name=""
                                  id="SO_PO_DS_whereWillitShipupdate"
                                  style="margin: 5px"
                                >
                                  <option value="">Select Ship From</option>
                                  <option value="">Our shop</option>
                                  <option value="">
                                    Our supplier direct to our customer
                                  </option>
                                </select>
                              </div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="upsFedexOurAccount_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px"
                          >
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for="ourAccount"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Our Account</label
                                >
                                <select
                                  id="SO_PO_UFOA_ourAccountupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="">UPS</option>
                                  <option value="">Fedex</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px"
                                  >Next Day Shipment Needed?</label
                                >
                                <select
                                  id="SO_PO_UFOA_nextdayshippmentupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="">Yes</option>
                                  <option value="">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px"
                                  >Regular Ground Shipment</label
                                >
                                <select
                                  id="SO_PO_UFOA_regulargroundshipmentupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="">Yes</option>
                                  <option value="">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px"
                                  >Charge Normal Mode</label
                                >
                                <select
                                  id="SO_PO_UFOA_chnagenormalmodeupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="">Yes</option>
                                  <option value="">No</option>
                                </select>
                              </div>
                            </div>
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for="accountNumber"
                                  class="form-label"
                                  style="margin: 5px"
                                  >Account Number</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_UFOA_accountNumberupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <input
                                  type="checkbox"
                                  style="margin-top: 12px"
                                  id="SO_PO_UFOA_needMultipleLocationsupdate"
                                  class="form-check-input"
                                />
                                <label
                                  for="needMultipleLocations"
                                  style="margin-top: 10px"
                                  class="form-check-label"
                                  >Need Multiple Locations</label
                                >
                              </div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="upsFedexCustomerAccount_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px"
                          >
                            <div class="row md-3">
                              <div class="col-md-3">
                                <input
                                  type="checkbox"
                                  id="SO_PO_UFCA_needMultipleLocationsCustomerupdate"
                                  class="form-check-input"
                                  style="margin: 7px"
                                />
                                <label
                                  for="needMultipleLocationsCustomer"
                                  class="form-check-label"
                                  style="margin: 4px"
                                  >Need Multiple Locations</label
                                >
                                <br />
                                <label
                                  for="customerAccount"
                                  class="form-label"
                                  style="margin: 5px; padding: 12px"
                                  >Customer Account</label
                                >
                                <select
                                  id="SO_PO_UFCA_customeraccountupdate"
                                  class="form-select"
                                >
                                  <option value="">Select an option</option>
                                  <option value="">UPS</option>
                                  <option value="">Fedex</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="customerAccountNumber"
                                  class="form-label"
                                  style="margin-bottom: 11px"
                                  >What is Customer Account Number to Charge For
                                  Shipping Amount</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_UFCA_customerAccountNumberupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="freightDelivery_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px"
                          >
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for="palletSize"
                                  class="form-label"
                                  style="padding: 4px; font-size: small"
                                  >Pallet Size Needed, Provide Estimate</label
                                >
                                <input
                                  type="text"
                                  id="SO_PO_FD_palletSizeupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="freightPickupArrangement"
                                  class="form-label"
                                  style="padding: 4px"
                                  >Who Will Arrange Freight Pickup?</label
                                >
                                <select
                                  id="SO_PO_FD_freightPickupArrangementupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="customer">Customer</option>
                                  <option value="company">1Source</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for="freightPickupDate"
                                  class="form-label"
                                  style="font-size: small"
                                  >Date Of Freight Pickup Required To Meet
                                  Customer Due Date</label
                                >
                                <input
                                  type="date"
                                  id="SO_PO_FD_freightPickupDateupdate"
                                  class="form-control"
                                />
                              </div>
                            </div>
                          </div>
                          <!--  -->
                          <div
                            id="install_SOupdate"
                            class="field-groupso"
                            style="padding-right: 10px; margin-bottom: 5px"
                          >
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Manufacture Type</label
                                >
                                <select
                                  id="ManufactureTypeSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="In-house">In-house</option>
                                  <option value="Outsource">Outsource</option>
                                  <option value="Combination">
                                    Combination
                                  </option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Install type</label
                                >
                                <select
                                  id="InstallTypeSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="Interior">Interior</option>
                                  <option value="Exterior">Exterior</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Sign permit required</label
                                >
                                <select
                                  id="SignPermitSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Electrical Permit required</label
                                >
                                <select
                                  id="ElectricalPermitSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Electrical connection made by us</label
                                >
                                <select
                                  id="ElectricalConnectionSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Miss DIG required</label
                                >
                                <select
                                  id="MissDigSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Has the wall recently been painted?</label
                                >
                                <select
                                  id="HasTheWallSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Is there a working elevator available?</label
                                >
                                <select
                                  id="IsThereWorkingSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="">Select an option</option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Is rental equipment needed</label
                                >
                                <select
                                  id="IsRentalSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >In-house large equipment needed</label
                                >
                                <select
                                  id="InHouseSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Is hardware needed</label
                                >
                                <select
                                  id="IsHardwareSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="Yes">Yes</option>
                                  <option value="No">No</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Hardware grade</label
                                >
                                <select
                                  id="HardwareGradeSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="" selected>
                                    Select an option
                                  </option>
                                  <option value="Interior">Interior</option>
                                  <option value="Exterior">Exterior</option>
                                </select>
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >What floor's will Signage be
                                  installed?</label
                                >
                                <input
                                  type="text"
                                  id="WhatFloorSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Number of Visits needed</label
                                >
                                <input
                                  type="text"
                                  id="NumberOFVIsitSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >How many installers needed</label
                                >
                                <input
                                  type="number"
                                  id="HowManyInstallerSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Approx fabrication time (Hours)</label
                                >
                                <input
                                  type="number"
                                  id="AppproxFaSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Estimated hours of travel (Hours)</label
                                >
                                <input
                                  type="number"
                                  id="EstimateHouerSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Estimated hours on site</label
                                >
                                <input
                                  type="number"
                                  id="EstimateHouerOnSiteSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Production due date</label
                                >
                                <input
                                  type="date"
                                  id="ProductionDueSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Fabrication due date</label
                                >
                                <input
                                  type="date"
                                  id="FabricationDUeSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Installation due date</label
                                >
                                <input
                                  type="date"
                                  id="InstallationDUeSOupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Type of Work Needed</label
                                >
                                <select
                                  name=""
                                  id="Type_of_Work_Neededupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                >
                                  <option value="Site Survey">
                                    Site Survey
                                  </option>
                                  <option value="Permit Request">
                                    Permit Request
                                  </option>
                                  <option value="Service Call">
                                    Service Call
                                  </option>
                                  <option value="Installation">
                                    Installation
                                  </option>
                                  <option value="Re-Visit / Re-Install">
                                    Re-Visit / Re-Install
                                  </option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Install Summary of Work</label
                                >
                                <textarea
                                  style="margin: 5px"
                                  id="Install_Summary_of_Workupdate"
                                  class="form-control"
                                  rows="4"
                                  placeholder="Enter Install Summary of Work here"
                                ></textarea>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Whta type of Hardware Specific</label
                                >
                                <input
                                  type="text"
                                  id="Whta_type_of_Hardware_Specificupdate"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >URL Link1</label
                                >
                                <input
                                  type="text"
                                  id="URL_Link1update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >URL Link2</label
                                >
                                <input
                                  type="text"
                                  id="URL_Link2update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Preferred Date 1</label
                                >
                                <input
                                  type="date"
                                  id="Preferred_Date_1update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Preferred Date 2</label
                                >
                                <input
                                  type="date"
                                  id="Preferred_Date_2update"
                                  class="form-control"
                                  style="margin: 5px"
                                />
                              </div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Preferred Time</label
                                >
                                <select
                                  class="form-section"
                                  name=""
                                  id="Preferred_Timeupdate"
                                  style="margin: 5px"
                                >
                                  <option value="">Morning</option>
                                  <option value="">Afternoon</option>
                                  <option value="">Evening</option>
                                </select>
                              </div>
                              <div class="col-md-3"></div>
                              <div class="col-md-3"></div>
                              <div class="col-md-3"></div>
                            </div>
                            <!--  -->
                            <div class="row md-3">
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Power Equipment Needed</label
                                >
                                <select
                                  id="PowerEquipmentSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                  multiple
                                >
                                  <option value="">Drywall</option>
                                  <option value="">Cement Board</option>
                                  <option value="">
                                    Plywood / Wood Paneling
                                  </option>
                                  <option value="">Glass</option>
                                  <option value="">Flat Steel</option>
                                  <option value="">Corrugated Steel</option>
                                  <option value="">
                                    Rough Stone / Faux Stone
                                  </option>
                                  <option value="">
                                    Smooth Stone / Concrete
                                  </option>
                                  <option value="">Tile</option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >In-house equipment</label
                                >
                                <select
                                  id="InhouseEqupmentSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                  multiple
                                >
                                  <option value="">Mini loader / auger</option>
                                  <option value="">Hand held auger</option>
                                  <option value="">Trailer</option>
                                  <option value="">Large ladder</option>
                                  <option value="">Jack hammer</option>
                                  <option value="">
                                    Generator / Compressor
                                  </option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="font-size: small"
                                  >Any obstruction in the install area?</label
                                >
                                <select
                                  id="AnyObstrictionSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                  multiple
                                >
                                  <option value="">Overhead Beams</option>
                                  <option value="">HVAC /Ducts</option>
                                  <option value="">Staircase</option>
                                  <option value="">Desk / Cabinets</option>
                                  <option value="">High Traffic Area</option>
                                  <option value="">Outlets / Lighting</option>
                                  <option value="">
                                    Trees / Bushes / Fences
                                  </option>
                                  <option value="">Powerlines</option>
                                  <option value="">Uneven Terrain</option>
                                  <option value="">
                                    Vehicles in parking lot
                                  </option>
                                </select>
                              </div>
                              <div class="col-md-3">
                                <label
                                  for=""
                                  class="form-label"
                                  style="margin: 5px; font-size: small"
                                  >Rental Equipment</label
                                >
                                <select
                                  id="RentalEquipmentSOupdate"
                                  class="form-select"
                                  style="margin: 5px"
                                  multiple
                                >
                                  <option value="">Scissor Lift (19â€™)</option>
                                  <option value="">Scissor Lift (26â€™)</option>
                                  <option value="">
                                    Towable Boom Lift (35â€™)
                                  </option>
                                  <option value="">
                                    Towable Boom Lift (50â€™)
                                  </option>
                                  <option value="">Bucket Truck</option>
                                  <option value="">Crane Truck</option>
                                </select>
                              </div>
                            </div>
                          </div>
                          <!-- end post production -->
                          <br />
                          <script>
                            document.addEventListener(
                              "DOMContentLoaded",
                              function () {
                                const dropdown = document.getElementById(
                                  "PostProductionUpdateSO"
                                );
                                dropdown.dispatchEvent(new Event("change"));
                              }
                            );
                            document
                              .getElementById("PostProductionUpdateSO")
                              .addEventListener("change", function () {
                                // Hide all field groups
                                const allFieldGroupsupdate =
                                  document.querySelectorAll(".field-groupso");
                                allFieldGroupsupdate.forEach(
                                  (group) => (group.style.display = "none")
                                );
                                // Show the selected field group
                                const selectedValueupdate = this.value;
                                if (selectedValueupdate) {
                                  document.getElementById(
                                    selectedValueupdate
                                  ).style.display = "block";
                                }
                              });
                          </script>
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Customer Due Date</label
                              >
                              <input
                                type="date"
                                id="Customer_due_date_SOUpdate"
                                class="form-control"
                                placeholder="Customer Due Date"
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Our Commitment Date</label
                              >
                              <input
                                type="date"
                                id="commitmentDateSOUpdate"
                                class="form-control"
                                placeholder="Our Commitment Date"
                              />
                            </div>
                          </div>
                          <!-- Below is item details for update -->
                          <div
                            style="
                              border: 1px solid #ddd;
                              padding: 20px;
                              border-radius: 5px;
                            "
                          >
                            <h5
                              style="
                                margin-bottom: 20px;
                                font-size: 18px;
                                font-weight: bold;
                              "
                            >
                              Item Details
                            </h5>
                            <div id="itemContainerUpdateSO"></div>
                            <div
                              style="margin-top: 20px; text-align: left"
                            ></div>
                            <div class="container">
                              <!-- Table Header -->
                              <!-- Container for dynamic rows -->
                              <div id="itemsContainerso" class="mt-2">
                                <!-- Dynamic item rows for SO is in the below -->
                              </div>
                              <button
                                type="button"
                                class="btn btn-primary mt-3"
                                id="addItemso"
                              >
                                + Add Item
                              </button>
                            </div>
                            <!-- jQuery Script to Add/Remove Rows -->
                            <script>
                              // //<div style=" width: 10px; margin-top: 25px;" >
                              //   <span style="color:red; width: 10px; height:10px; "><i class="fa fa-x hoverCSS remove-itemso"></i></span>
                              //  </div>
                              $(document).ready(function () {
                                $("#addItemso").click(function () {
                                  $("#itemsContainerso").append(`
                                    <!-- Row of Fields -->
                                        <div class="row item-rowso" id="" style="display: flex; align-items: center; flex-wrap: wrap; font-weight: bold;">
                                          <div style="flex: 1; min-width: 120px;">
                                                    <label class="form-label">Product Type</label>
                                                  <select id="productTypeAddRowSO" class="productTypeAddRowSO form-select">
                                                      <option>Select Type</option>
                                                  </select>
                                            </div>
                                            <div style="flex: 1; min-width: 120px;">
                                                <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                                                <input type="text" id="item-nameAddRowso" placeholder="Item"
                                                    class="item-nameAddRowso form-control form-control-sm"
                                                    style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                            </div>
                                            <div style="flex: 1; min-width: 80px;">
                                                <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                                                <input type="number" id="itemqtyAddRowso" placeholder="Qty"
                                                    class="item-codeAddRowso form-control form-control-sm"
                                                    style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                            </div>
                      
                                           <div style="flex: 2; min-width: 200px;">
                                                  <label for="Description" class="form-label"
                                                      style="margin-bottom: 5px; display: block;">Description</label>
                                                  <textarea name="Description" id="Description_AddRowso" rows="1"
                                                      class="Description_AddRowso form-control form-control-sm" placeholder="Description"
                                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; "></textarea>
                                              </div>
                      
                                            <div style="flex: 1; min-width: 120px;">
                                                <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                                                <select id="itemUnitAddRowso" class="itemUnitAddRowso form-select form-select-sm"
                                                    style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                                    <option>Box</option>
                                                    <option>Each</option>
                                                    <option>Feet</option>
                                                    <option>Sq Feet</option>
                                                    <option>Sheet</option>
                                                    <option>Pieces</option>
                                                    <option>Units</option>
                                                </select>
                                            </div>
                                            <div style="flex: 1; min-width: 120px;">
                                                <label for="Cost" class="form-label" style="margin-bottom: 5px; display: block; font-size: medium;">Piece Cost
                                                    ($)</label>
                                                <input type="number" id="priceCostAddRowso" class="priceCostAddRowso form-control form-control-sm"
                                                    placeholder="Piece Cost ($)"
                                                    style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                            </div>
                                            <div style="flex: 1; min-width: 120px;">
                                                <label for="Markup" class="form-label" style="margin-bottom: 5px; display: block;">Markup
                                                    (%)</label>
                                                <input type="number" id="markupAddRowso" class="markupAddRowso form-control form-control-sm"
                                                    placeholder="Markup (%)"
                                                    style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                            </div>
                                        </div>
                                        <hr style="margin-bottom: 8px; border: none;color: transparent; background-color: transparent;">
                            `);
                                });
                                // $(document).on(
                                //   "click",
                                //   ".remove-itemso",
                                //   function () {
                                //     $(this).closest(".item-rowso").remove();
                                //   }
                                // );
                              });
                            </script>
                          </div>
                          <!--  -->
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="notes" class="form-label"
                                >Notes</label
                              >
                              <textarea
                                id="notesUpdateSO"
                                class="form-control"
                                rows="4"
                                placeholder=""
                              ></textarea>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Private Notes</label
                              >
                              <textarea
                                id="privateNoteUpdateSO"
                                class="form-control"
                                rows="4"
                                placeholder="Enter private notes here"
                              ></textarea>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="col-sm-6 col-form-label"
                                >Down Payment (%)</label
                              >
                              <input
                                type="text"
                                id="downPaymentPercentUpdateso"
                                class="form-control"
                                placeholder="0%"
                              />
                              <span style="color: darkred"
                                >Put only number not %</span
                              >
                            </div>
                          </div>
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Close
                        </button>
                        <button
                          type="button"
                          class="btn btn-primary"
                          id="SOupdateChanges"
                        >
                          Save changes
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <script>
                  document.addEventListener("DOMContentLoaded", () => {
                    const editModalTitleso =
                      document.getElementById("editModalSO");
                    const modalTitleViewSO =
                      document.getElementById("editModalLabelSO");

                    editModalTitleso.addEventListener(
                      "show.bs.modal",
                      (event) => {
                        const buttonviewSO = event.relatedTarget; // Button that triggered the modal
                        const statusCellviewso = buttonviewSO
                          .closest("tr")
                          .querySelector(".status-cellso")
                          .textContent.trim()
                          .toLowerCase();

                        // Set modal title based on status for Sales order
                        modalTitleViewSO.textContent =
                          statusCellviewso === "draft"
                            ? "Edit Sales Order"
                            : "View Sales Order";
                      }
                    );
                  });
                </script>
                <!-- above is script for Dynamic text for so modal title -->
              </tbody>
            </table>
          </div>
        </div>
        <div class="form-section" id="formSectionso">
          <div class="header-with-closeso">
            <h4>Create New Salesorder</h4>
            <button class="close-buttonso" onclick="toggleFormso(false)">
              X
            </button>
          </div>
          <br />
          <div style="font-weight: bold" id="createsalesorderForm">
            <div class="row mb-3">
              <div class="col-md-3">
                <label style="padding: 3px" for="" class="form-label"
                  >SO Date</label
                >
                <input
                  style="padding: 7px"
                  type="text"
                  id="dateFieldso"
                  placeholder="Date"
                  class="form-control"
                  readonly
                />
                <script>
                  // Function to get the current date
                  function displayCurrentDate() {
                    const today = new Date(); // Get the current date and time
                    const year = today.getFullYear();
                    const month = String(today.getMonth() + 1).padStart(2, "0"); // Months are 0-based
                    const day = String(today.getDate()).padStart(2, "0");
                    // Format the date as YYYY-MM-DD
                    const formattedDate = `${year}-${month}-${day}`;
                    // Display the date in the input field
                    document.getElementById("dateFieldso").value =
                      formattedDate;
                  }
                  // Call the function to set the date on page load
                  displayCurrentDate();
                </script>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">SO Name</label
                ><span class="requiredFields"> *</span>
                <input
                  style="padding: 7px"
                  type="text"
                  id="SOName"
                  class="form-control"
                  placeholder="SO Name"
                  required
                />
              </div>
              <div class="col-md-3">
                <label for="taxRate" class="form-label">Tax Rate</label
                ><span class="requiredFields"> *</span>
                <select
                  style="padding: 7px"
                  id="taxRateSO"
                  class="form-select"
                  title="tax"
                  required
                >
                  <option selected>Select</option>
                  <option value="0%">0%</option>
                  <option value="6%">6%</option>
                </select>
              </div>
              <div class="col-md-3">
                <label style="padding: 3px" for="" class="form-label"
                  >Salesperson</label
                >
                <select
                  style="padding: 7px"
                  id="salespersonSelectSO"
                  name=""
                  class="form-select"
                >
                  <option>Select Salesperson</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label">CRM Account Name</label
                ><span class="requiredFields"> *</span>
                <input
                  style="padding: 7px"
                  type="text"
                  placeholder="CRM Account Name"
                  id="accountNameSO"
                  class="form-control"
                  readonly
                />
              </div>
              <div class="col-md-3">
                <label style="padding: 3px" for="" class="form-label"
                  >CRM Contact Name</label
                >
                <select
                  style="padding: 7px"
                  id="contactSelectFieldSO"
                  class="form-select"
                  title="Contact name"
                >
                  <option value="" selected>Select a Contact</option>
                </select>
              </div>
              <div class="col-md-3">
                <label
                  style="padding: 3px"
                  for="locationName"
                  class="form-label"
                  >Bill To Location</label
                >
                <select
                  style="padding: 7px"
                  id="addressSelectFieldSO"
                  class="form-select"
                  title="Bill To Location"
                >
                  <option value="" selected>Select</option>
                </select>
              </div>
              <div class="col-md-3">
                <label
                  style="padding: 3px"
                  for="vendorNumber"
                  class="form-label"
                  >Vendor Number</label
                >
                <input
                  style="padding: 7px"
                  type="text"
                  id="vendorNumberSO"
                  class="form-control"
                  placeholder="Vendor Number"
                  readonly
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label class="form-label" for="estimateSearch"
                  >Search Estimate:</label
                >
                <input
                  class="form-control"
                  style="padding: 7px"
                  type="text"
                  id="estimateSearch"
                  placeholder="Type to search..."
                />
              </div>
              <div class="col-md-3">
                <label class="form-label" for="estimateDropdown"
                  >Select Estimate:</label
                >
                <select
                  style="padding: 7px"
                  class="form-select"
                  id="estimateDropdown"
                >
                  <option value="">Loading...</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Permit Needed? <span style="color: red"> *</span></label
                >
                <select
                  style="padding: 7px"
                  id="permitNeededSO"
                  class="form-select"
                  title="Permit Needed?"
                  required
                >
                  <option selected>Select Permit</option>
                  <option>Yes</option>
                  <option>No</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Is Design Proof Needed?
                  <span style="color: red"> *</span></label
                >
                <select
                  style="padding: 7px"
                  id="designProofSO"
                  class="form-select"
                  title="Design Proof Needed?"
                  required
                >
                  <option selected>Select Design Proof</option>
                  <option>Yes</option>
                  <option>No</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Vendor Input Need? <span style="color: red"> *</span></label
                >
                <select
                  style="padding: 7px"
                  id="vendorInputSO"
                  class="form-select"
                  title="Vendor Input Need?"
                  required
                >
                  <option selected>Select Vendor Input</option>
                  <option>Yes</option>
                  <option>No</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Approved On</label>
                <input
                  style="padding: 7px"
                  type="date"
                  id="approvedOnSO"
                  class="form-control"
                  placeholder="Approved On"
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Customer Due Date <span style="color: red"> *</span></label
                >
                <input
                  style="padding: 7px"
                  type="date"
                  id="Customer_due_date_SO"
                  class="form-control"
                  placeholder="Customer Due Date"
                  required
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Our Commitment Date <span style="color: red"> *</span></label
                >
                <input
                  style="padding: 7px"
                  type="date"
                  id="commitmentDateSO"
                  class="form-control"
                  placeholder="Our Commitment Date"
                  required
                />
              </div>
            </div>
            <div class="row mb-3">
              <!-- Did Customer Provide a Customer PO# Dropdown -->
              <div class="col-md-3">
                <label style="padding: 2px" for="" class="form-label"
                  >Did Client Provide PO#</label
                >
                <select id="customerPOSO" class="form-select" name="" title="">
                  <option value="">Select Customer PO</option>
                  <option value="Yes">Yes</option>
                  <option value="No">No</option>
                </select>
              </div>
              <!-- Conditional Customer PO -->
              <div
                id="poNumberSO"
                style="padding: 3px; display: none"
                class="col-md-3"
              >
                <label for="" class="form-label">PO Number</label>
                <input
                  style="padding: 7px"
                  type="text"
                  id="poNumberSO1"
                  class="form-control"
                  placeholder="PO Number"
                />
              </div>
              <!--  -->
              <script>
                // Event listener for customer po dropdown
                document
                  .getElementById("customerPOSO")
                  .addEventListener("change", function () {
                    const approverDataField =
                      document.getElementById("poNumberSO");
                    if (this.value === "Yes") {
                      approverDataField.style.display = "block"; // Show approver field
                    } else {
                      approverDataField.style.display = "none"; // Hide approver field
                    }
                  });
              </script>
              <div class="col-md-3">
                <label style="padding: 2px" for="" class="form-label"
                  >Site Survey Needed</label
                >
                <select
                  style="padding: 7px"
                  id="siteSurveySO"
                  class="form-select"
                  title="Site Survey Needed"
                >
                  <option selected>Select Site Survey</option>
                  <option>Yes</option>
                  <option>No</option>
                </select>
              </div>
              <div class="col-md-3">
                <label style="padding: 2px" for="" class="form-label"
                  >Lead Time (Biz Days)</label
                >
                <input
                  style="padding: 7px"
                  type="number"
                  id="leadTimeSO"
                  class="form-control"
                  placeholder="Lead Time From Approval (Business Days)"
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <!-- Post Production Dropdown -->
                <label
                  for="Post_Production"
                  class="form-label"
                  style="padding: 7px; display: block"
                  >Post Production<span
                    style="
                      color: red;
                      font-size: 20px;
                      margin-left: 2px;
                      margin-top: -4px;
                    "
                  >
                    *</span
                  ></label
                >
                <select
                  id="Post_Production_dropdown_SO"
                  style="padding: 7px"
                  class="form-select"
                  title="Post Production"
                  required
                >
                  <option value="" selected>Select Post Production</option>
                  <option value="deliverOurVehicle_SO">
                    We Deliver (Our Vehicle)
                  </option>
                  <option value="deliverRentedTruck_SO">
                    We Deliver (Rented Truck)
                  </option>
                  <option value="customerPickup_SO">Customer Pickup</option>
                  <option value="dropship_SO">Dropship</option>
                  <option value="upsFedexOurAccount_SO">
                    Send UPS/Fedex (Our Account)
                  </option>
                  <option value="upsFedexCustomerAccount_SO">
                    Send UPS/Fedex (Customer Account)
                  </option>
                  <option value="freightDelivery_SO">Freight Delivery</option>
                  <option value="install_SO">Install</option>
                  <option value="unknown_SO">Unknown</option>
                </select>
              </div>
            </div>

            <!-- Field Groups -->
            <div id="deliverOurVehicle_SO" class="field-group">
              <label for="deliveryAddress" class="form-label"
                >Delivery Address</label
              >
              <br />
              <div class="row mb-3">
                <div class="col-md-3">
                  <label
                    for="addressLine1"
                    class="form-label"
                    style="margin: 5px"
                    >Address Line 1</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DOV_addressLine1"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="addressLine2"
                    class="form-label"
                    style="margin: 5px"
                    >Address Line 2</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DOV_addressLine2"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label for="city" class="form-label" style="margin: 5px"
                    >City</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DOV_city"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label for="state" class="form-label" style="margin: 5px"
                    >State</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DOV_state"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-md-3">
                  <label for="zipCode" class="form-label" style="margin: 5px"
                    >Zip Code</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DOV_zipCode"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="deliveryDate"
                    class="form-label mt-2"
                    style="margin: 5px"
                    >Desired Delivery Date</label
                  >
                  <input
                    type="date"
                    id="SO_PO_DOV_deliveryDate"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
            </div>
            <!--  -->
            <div
              id="deliverRentedTruck_SO"
              class="field-group"
              style="padding-right: 10px"
            >
              <div class="row md-3">
                <span>Delivery Address</span>
                <div class="col-md-3">
                  <label
                    for="addressLine1"
                    class="form-label"
                    style="margin: 5px"
                    >Address Line 1</label
                  >
                  <input
                    type="text"
                    id="aSO_PO_DRT_ddressLine1"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="addressLine2"
                    class="form-label"
                    style="margin: 5px"
                    >Address Line 2</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DRT_addressLine2"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label for="city" class="form-label" style="margin: 5px"
                    >City</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DRT_city"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label for="state" class="form-label" style="margin: 5px"
                    >State</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DRT_state"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-md-3">
                  <label for="zipCode" class="form-label" style="margin: 5px"
                    >Zip Code</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DRT_zipCode"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="vehicleNumber"
                    class="form-label"
                    style="margin: 5px"
                    >Vehicle Number</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DRT_vehicleNumber"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="rentedDeliveryDate"
                    class="form-label mt-2"
                    style="margin: 5px"
                    >Desired Delivery Date</label
                  >
                  <input
                    type="date"
                    id="SO_PO_DRT_rentedDeliveryDate"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3"></div>
              </div>
            </div>
            <!--  -->
            <div
              id="customerPickup_SO"
              class="field-group"
              style="padding-right: 10px"
            >
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for="knowWhoIsPickingUp"
                    class="form-label"
                    style="margin: 5px"
                    >Do We Know Who is Picking Up?</label
                  >
                  <select
                    id="SO_PO_CP_knowWhoIsPickingUp"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" style="margin: 5px">
                      Select an option
                    </option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for="knowWhenPickup"
                    class="form-label mt-2"
                    style="font-size: small"
                    >Do We Know When Will Customer Pickup?</label
                  >
                  <select
                    id="SO_PO_CP_knowWhenPickup"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" style="margin: 5px">
                      Select an option
                    </option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for="pickupName"
                    class="form-label mt-2"
                    style="margin: 5px"
                    >Name</label
                  >
                  <input
                    type="text"
                    id="SO_PO_CP_pickupName"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="pickupDate"
                    class="form-label mt-2"
                    style="margin: 5px"
                    >Pickup Date</label
                  >
                  <input
                    type="date"
                    id="SO_PO_CP_pickupDate"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
            </div>
            <!--  -->
            <div
              id="dropship_SO"
              class="field-group"
              style="padding-right: 10px"
            >
              <div class="row md-3">
                <span>Ship-To Address</span>
                <div class="col-md-3">
                  <label
                    for="addressLine1"
                    class="form-label"
                    style="margin: 5px"
                    >Address Line 1</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DS_addressLine1"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="addressLine2"
                    class="form-label"
                    style="margin: 5px"
                    >Address Line 2</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DS_addressLine2"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label for="city" class="form-label" style="margin: 5px"
                    >City</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DS_city"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label for="state" class="form-label" style="margin: 5px"
                    >State</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DS_state"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <div class="row md-3">
                <div class="col-md-3">
                  <label for="zipCode" class="form-label" style="margin: 5px"
                    >Zip Code</label
                  >
                  <input
                    type="text"
                    id="SO_PO_DS_zipCode"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="shipFrom"
                    class="form-label mt-2"
                    style="margin: 5px"
                    >Where Will it Ship From?</label
                  >
                  <select
                    class="form-select"
                    name=""
                    id="SO_PO_DS_whereWillitShip"
                    style="margin: 5px"
                  >
                    <option value="">Select Ship From</option>
                    <option value="">Our shop</option>
                    <option value="">
                      Our supplier direct to our customer
                    </option>
                  </select>
                </div>
              </div>
            </div>
            <!--  -->
            <div
              id="upsFedexOurAccount_SO"
              class="field-group"
              style="padding-right: 10px"
            >
              <div class="row md-3">
                <div class="col-md-3">
                  <label for="ourAccount" class="form-label" style="margin: 5px"
                    >Our Account</label
                  >
                  <select
                    id="SO_PO_UFOA_ourAccount"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="">UPS</option>
                    <option value="">Fedex</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label for="" class="form-label" style="margin: 5px"
                    >Next Day Shipment Needed?</label
                  >
                  <select
                    id="SO_PO_UFOA_nextdayshippment"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="">Yes</option>
                    <option value="">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label for="" class="form-label" style="margin: 5px"
                    >Regular Ground Shipment</label
                  >
                  <select
                    id="SO_PO_UFOA_regulargroundshipment"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="">Yes</option>
                    <option value="">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label for="" class="form-label" style="margin: 5px"
                    >Charge Normal Mode</label
                  >
                  <select
                    id="SO_PO_UFOA_chnagenormalmode"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="">Yes</option>
                    <option value="">No</option>
                  </select>
                </div>
              </div>
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for="accountNumber"
                    class="form-label"
                    style="margin: 5px"
                    >Account Number</label
                  >
                  <input
                    type="text"
                    id="SO_PO_UFOA_accountNumber"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <input
                    type="checkbox"
                    style="margin-top: 12px"
                    id="SO_PO_UFOA_needMultipleLocations"
                    class="form-check-input"
                  />
                  <label
                    for="needMultipleLocations"
                    style="margin-top: 10px"
                    class="form-check-label"
                    >Need Multiple Locations</label
                  >
                </div>
              </div>
            </div>
            <!--  -->
            <div
              id="upsFedexCustomerAccount_SO"
              class="field-group"
              style="padding-right: 10px"
            >
              <div class="row md-3">
                <div class="col-md-3">
                  <input
                    type="checkbox"
                    id="SO_PO_UFCA_needMultipleLocationsCustomer"
                    class="form-check-input"
                    style="margin: 7px"
                  />
                  <label
                    for="needMultipleLocationsCustomer"
                    class="form-check-label"
                    style="margin: 4px"
                    >Need Multiple Locations</label
                  >
                  <br />
                  <label
                    for="customerAccount"
                    class="form-label"
                    style="margin: 5px; padding: 12px"
                    >Customer Account</label
                  >
                  <select id="SO_PO_UFCA_customeraccount" class="form-select">
                    <option value="">Select an option</option>
                    <option value="">UPS</option>
                    <option value="">Fedex</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for="customerAccountNumber"
                    class="form-label"
                    style="margin-bottom: 11px"
                    >What is Customer Account Number to Charge For Shipping
                    Amount</label
                  >
                  <input
                    type="text"
                    id="SO_PO_UFCA_customerAccountNumber"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
            </div>
            <!--  -->
            <div
              id="freightDelivery_SO"
              class="field-group"
              style="padding-right: 10px"
            >
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for="palletSize"
                    class="form-label"
                    style="padding: 4px; font-size: small"
                    >Pallet Size Needed, Provide Estimate</label
                  >
                  <input
                    type="text"
                    id="SO_PO_FD_palletSize"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for="freightPickupArrangement"
                    class="form-label"
                    style="padding: 4px"
                    >Who Will Arrange Freight Pickup?</label
                  >
                  <select
                    id="SO_PO_FD_freightPickupArrangement"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="customer">Customer</option>
                    <option value="company">1Source</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for="freightPickupDate"
                    class="form-label"
                    style="font-size: small"
                    >Date Of Freight Pickup Required To Meet Customer Due
                    Date</label
                  >
                  <input
                    type="date"
                    id="SO_PO_FD_freightPickupDate"
                    class="form-control"
                  />
                </div>
              </div>
            </div>
            <!--  -->
            <div
              id="install_SO"
              class="field-group"
              style="padding-right: 10px; margin-bottom: 5px"
            >
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Manufacture Type</label
                  >
                  <select
                    id="ManufactureTypeSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="In-house">In-house</option>
                    <option value="Outsource">Outsource</option>
                    <option value="Combination">Combination</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Install type</label
                  >
                  <select
                    id="InstallTypeSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="Interior">Interior</option>
                    <option value="Exterior">Exterior</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Sign permit required</label
                  >
                  <select
                    id="SignPermitSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Electrical Permit required</label
                  >
                  <select
                    id="ElectricalPermitSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Electrical connection made by us</label
                  >
                  <select
                    id="ElectricalConnectionSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Miss DIG required</label
                  >
                  <select
                    id="MissDigSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Has the wall recently been painted?</label
                  >
                  <select
                    id="HasTheWallSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Is there a working elevator available?</label
                  >
                  <select
                    id="IsThereWorkingSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="">Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Is rental equipment needed</label
                  >
                  <select
                    id="IsRentalSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >In-house large equipment needed</label
                  >
                  <select
                    id="InHouseSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Is hardware needed</label
                  >
                  <select
                    id="IsHardwareSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Hardware grade</label
                  >
                  <select
                    id="HardwareGradeSO"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="" selected>Select an option</option>
                    <option value="Interior">Interior</option>
                    <option value="Exterior">Exterior</option>
                  </select>
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >What floor's will Signage be installed?</label
                  >
                  <input
                    type="text"
                    id="WhatFloorSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Number of Visits needed</label
                  >
                  <input
                    type="text"
                    id="NumberOFVIsitSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >How many installers needed</label
                  >
                  <input
                    type="number"
                    id="HowManyInstallerSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Approx fabrication time (Hours)</label
                  >
                  <input
                    type="number"
                    id="AppproxFaSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Estimated hours of travel (Hours)</label
                  >
                  <input
                    type="number"
                    id="EstimateHouerSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Estimated hours on site</label
                  >
                  <input
                    type="number"
                    id="EstimateHouerOnSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Production due date</label
                  >
                  <input
                    type="date"
                    id="ProductionDueSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Fabrication due date</label
                  >
                  <input
                    type="date"
                    id="FabricationDUeSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Installation due date</label
                  >
                  <input
                    type="date"
                    id="InstallationDUeSO"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Type of Work Needed</label
                  >
                  <select
                    name=""
                    id="Type_of_Work_Needed"
                    class="form-select"
                    style="margin: 5px"
                  >
                    <option value="Site Survey">Site Survey</option>
                    <option value="Permit Request">Permit Request</option>
                    <option value="Service Call">Service Call</option>
                    <option value="Installation">Installation</option>
                    <option value="Re-Visit / Re-Install">
                      Re-Visit / Re-Install
                    </option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Install Summary of Work</label
                  >
                  <textarea
                    style="margin: 5px"
                    id="Install_Summary_of_Work"
                    class="form-control"
                    rows="4"
                    placeholder="Enter Install Summary of Work here"
                  ></textarea>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Whta type of Hardware Specific</label
                  >
                  <input
                    type="text"
                    id="Whta_type_of_Hardware_Specific"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >URL Link1</label
                  >
                  <input
                    type="text"
                    id="URL_Link1"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >URL Link2</label
                  >
                  <input
                    type="text"
                    id="URL_Link2"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Preferred Date 1</label
                  >
                  <input
                    type="date"
                    id="Preferred_Date_1"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Preferred Date 2</label
                  >
                  <input
                    type="date"
                    id="Preferred_Date_2"
                    class="form-control"
                    style="margin: 5px"
                  />
                </div>
              </div>
              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Preferred Time</label
                  >
                  <select
                    class="form-section"
                    name=""
                    id="Preferred_Time"
                    style="margin: 5px"
                  >
                    <option value="">Morning</option>
                    <option value="">Afternoon</option>
                    <option value="">Evening</option>
                  </select>
                </div>
                <div class="col-md-3"></div>
                <div class="col-md-3"></div>
                <div class="col-md-3"></div>
              </div>

              <!--  -->
              <div class="row md-3">
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Power Equipment Needed</label
                  >
                  <select
                    id="PowerEquipmentSO"
                    class="form-select"
                    style="margin: 5px"
                    multiple
                  >
                    <option value="">Drywall</option>
                    <option value="">Cement Board</option>
                    <option value="">Plywood / Wood Paneling</option>
                    <option value="">Glass</option>
                    <option value="">Flat Steel</option>
                    <option value="">Corrugated Steel</option>
                    <option value="">Rough Stone / Faux Stone</option>
                    <option value="">Smooth Stone / Concrete</option>
                    <option value="">Tile</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >In-house equipment</label
                  >
                  <select
                    id="InhouseEqupmentSO"
                    class="form-select"
                    style="margin: 5px"
                    multiple
                  >
                    <option value="">Mini loader / auger</option>
                    <option value="">Hand held auger</option>
                    <option value="">Trailer</option>
                    <option value="">Large ladder</option>
                    <option value="">Jack hammer</option>
                    <option value="">Generator / Compressor</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label for="" class="form-label" style="font-size: small"
                    >Any obstruction in the install area?</label
                  >
                  <select
                    id="AnyObstrictionSO"
                    class="form-select"
                    style="margin: 5px"
                    multiple
                  >
                    <option value="">Overhead Beams</option>
                    <option value="">HVAC /Ducts</option>
                    <option value="">Staircase</option>
                    <option value="">Desk / Cabinets</option>
                    <option value="">High Traffic Area</option>
                    <option value="">Outlets / Lighting</option>
                    <option value="">Trees / Bushes / Fences</option>
                    <option value="">Powerlines</option>
                    <option value="">Uneven Terrain</option>
                    <option value="">Vehicles in parking lot</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label
                    for=""
                    class="form-label"
                    style="margin: 5px; font-size: small"
                    >Rental Equipment</label
                  >
                  <select
                    id="RentalEquipmentSO"
                    class="form-select"
                    style="margin: 5px"
                    multiple
                  >
                    <option value="">Scissor Lift (19â€™)</option>
                    <option value="">Scissor Lift (26â€™)</option>
                    <option value="">Towable Boom Lift (35â€™)</option>
                    <option value="">Towable Boom Lift (50â€™)</option>
                    <option value="">Bucket Truck</option>
                    <option value="">Crane Truck</option>
                  </select>
                </div>
              </div>
            </div>
            <!-- end post production -->
            <br />
            <!-- Item Details SO-->
            <div
              style="border: 1px solid #ddd; padding: 20px; border-radius: 5px"
            >
              <h5
                style="margin-bottom: 20px; font-size: 18px; font-weight: bold"
              >
                Item Details
              </h5>
              <div id="itemContainerSO">
                <div class="item-rowSO" style="margin-bottom: 20px">
                  <div
                    class="row"
                    id="row1SO"
                    style="display: flex; align-items: center; flex-wrap: wrap"
                  >
                    <div
                      onclick="removeRowSO(this)"
                      style="width: 10px; margin-top: 25px"
                    >
                      <span style="color: red; width: 10px; height: 10px"
                        ><i class="fa fa-x hoverCSS"></i
                      ></span>
                    </div>
                    <div style="flex: 1">
                      <label
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Product Type</label
                      >
                      <select
                        id="productTypeSO"
                        class="productTypeSO form-select"
                      >
                        <option>Select Type</option>
                      </select>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Item"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Item</label
                      >
                      <input
                        type="text"
                        id="item-nameSO"
                        placeholder="Item"
                        class="item-nameSO form-control form-control-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Qty"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Qty</label
                      >
                      <input
                        type="number"
                        id="itemqtySO"
                        placeholder="Qty"
                        class="item-codeSO form-control form-control-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 2">
                      <label
                        for="Description"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Description</label
                      >
                      <textarea
                        name="Description"
                        id="itemdescSO"
                        rows="1"
                        class="Description-SO form-control form-control-sm"
                        placeholder="Description"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                          resize: none;
                        "
                      ></textarea>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Unit"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Unit</label
                      >
                      <select
                        id="itemUnitSO"
                        class="itemUnitSO form-select form-select-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      >
                        <option>Box</option>
                        <option>Each</option>
                        <option>Feet</option>
                        <option>Sq Feet</option>
                        <option>Sheet</option>
                        <option>Pieces</option>
                        <option>Units</option>
                      </select>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Cost"
                        class="form-label"
                        style="
                          margin-bottom: 5px;
                          display: block;
                          font-size: medium;
                        "
                        >Piece Cost ($)</label
                      >
                      <input
                        type="number"
                        id="priceCostSO"
                        class="priceCostSO form-control form-control-sm"
                        placeholder="Piece Cost ($)"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Markup"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Markup (%)</label
                      >
                      <input
                        type="number"
                        id="markupSO"
                        class="markupSO form-control form-control-sm"
                        placeholder="Markup (%)"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                  </div>
                </div>
              </div>
              <div style="margin-top: 20px; text-align: left">
                <button
                  onclick="addRowSO()"
                  class="btn btn-primary btn-sm"
                  style="font-size: 14px"
                >
                  + Add Item
                </button>
              </div>
            </div>
            <!--  -->
            <br />
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="notes" class="form-label">Notes</label>
                <textarea
                  id="notesSO"
                  class="form-control"
                  rows="4"
                  placeholder="Enter notes here"
                ></textarea>
              </div>
              <div class="col-md-3">
                <label for="privateNotes" class="form-label"
                  >Private Notes</label
                >
                <textarea
                  id="privateNotesSO"
                  class="form-control"
                  rows="4"
                  placeholder="Enter private notes here"
                ></textarea>
              </div>
              <div class="col-md-3"></div>
              <div class="col-md-3">
                <label
                  for="downPaymentPercent"
                  class="col-sm-6 col-form-label"
                  style="font-size: medium"
                  >Down Payment</label
                >
                <input
                  type="text"
                  id="downPaymentPercentSO"
                  class="form-control"
                  placeholder="Percent(%)"
                />
                <span style="color: darkred">Put only number not %</span>
              </div>
            </div>
            <h4 class="mt-4">Address Details</h4>
            <div class="row">
              <!-- Billing Details -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="billingName" class="form-label"
                    >Billing Name:</label
                  >
                  <input
                    type="text"
                    id="billingNameSO"
                    class="form-control"
                    placeholder="Enter Billing Name"
                    readonly
                  />
                </div>
                <div class="mb-3">
                  <label for="billTo" class="form-label">Bill To:</label>
                  <input
                    type="text"
                    id="billingStreetSO"
                    class="form-control"
                    placeholder="Address Line 1"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingStreetline2SO"
                    class="form-control"
                    placeholder="Address Line 2"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingCitySO"
                    class="form-control"
                    placeholder="City"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingStateSO"
                    class="form-control"
                    placeholder="State"
                    readonly
                  />
                  <input
                    type="text"
                    id="billingCodeSO"
                    class="form-control"
                    placeholder="Zip Code"
                    readonly
                  />
                </div>
              </div>
              <!-- Shipping Details -->
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="shippingName" class="form-label"
                    >Shipping Name:</label
                  >
                  <input
                    type="text"
                    id="shippingNameSO"
                    class="form-control"
                    placeholder="Enter Shipping Name"
                    readonly
                  />
                </div>
                <div class="mb-3">
                  <label for="shipTo" class="form-label">Ship To:</label>
                  <input
                    type="text"
                    id="shippingStreetSO"
                    class="form-control"
                    placeholder="Address Line 1"
                    readonly
                  />
                  <input
                    type="text"
                    id="Address_line2_CRMSO"
                    class="form-control"
                    placeholder="Address Line 2"
                    readonly
                  />
                  <input
                    type="text"
                    id="shippingCitySO"
                    class="form-control"
                    placeholder="City"
                    readonly
                  />
                  <input
                    type="text"
                    id="shippingStateSO"
                    class="form-control"
                    placeholder="State"
                    readonly
                  />
                  <input
                    type="text"
                    id="shippingCodeSO"
                    class="form-control"
                    placeholder="Zip Code"
                    readonly
                  />
                </div>
                <div class="mb-3">
                  <label for="" class="form-label">Phone</label>
                  <input
                    type="text"
                    id="phoneSO"
                    class="form-control"
                    placeholder="Phone"
                    readonly
                  />
                </div>
                <!-- <div class="mb-3">
                <label for="description" class="form-label" >Description</label>
                <textarea id="descriptionAddressSO" class="form-control" rows="3"
                  placeholder="Enter description here" readonly></textarea>
              </div> -->
              </div>
            </div>
            <!-- Reference URL -->
            <h4 class="mt-4">Reference URL</h4>
            <div class="url-fields row">
              <div class="col-md-4">
                <input
                  id="urlEs1SO"
                  type="url"
                  class="form-control"
                  placeholder="URL 1"
                />
              </div>
              <div class="col-md-4">
                <input
                  id="urlEs2SO"
                  type="url"
                  class="form-control"
                  placeholder="URL 2"
                />
              </div>
              <div class="col-md-4">
                <input
                  id="urlEs3SO"
                  type="url"
                  class="form-control"
                  placeholder="URL 3"
                />
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <h4 class="mt-4">Customer Attachments</h4>

                <div id="attachments_containerSO">
                  <label for="" class="form-label">File Upload</label>
                  <input
                    type="file"
                    multiple
                    id="fileInputCustomerSO"
                    class="form-control"
                    title="file"
                  />
                </div>
                <p style="color: #007bff; margin-top: 5px">
                  You can select multiple files.
                </p>
              </div>
              <div class="col-md-6">
                <h4 class="mt-4">Private Attachments</h4>
                <div id="attachments_containerPrivateSO">
                  <label for="" class="form-label">File Upload</label>
                  <input
                    type="file"
                    multiple
                    id="fileInputPrivateSO"
                    class="form-control"
                    title="file"
                  />
                </div>
                <p style="color: #007bff; margin-top: 5px">
                  You can select multiple files.
                </p>
              </div>
            </div>
            <br />
            <p
              id="errorMessageSo"
              style="font-size: 13px; color: red; display: none"
            >
              (*) Fields are required!
            </p>
            <div class="form-buttons">
              <button type="button" class="submit-button" id="soBtn">
                Submit
              </button>
              <button
                type="button"
                class="cancel-button"
                onclick="toggleFormso(false)"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
        <!-- Design Order Tab -->
        <div
          class="tab-pane fade"
          id="Designorder"
          role="tabpanel"
          aria-labelledby="Designorder-tab"
        >
          <div
            class="tab-pane fade show"
            id="Desginorder-create"
            role="tabpanel"
            aria-labelledby="Designorder-create-tab"
          >
            <div class="headerdo">
              <h1 id="listViewHeaderdo">Design Order List View</h1>
              <button class="addbuttondo" onclick="toggleFormdo(true)">
                + Create Designorder
              </button>
            </div>
          </div>
          <div id="listViewdo">
            <table id="designOrderTable">
              <thead>
                <tr>
                  <th>Design Order ID</th>
                  <th>Customer Due Date</th>
                  <th>DO Name</th>
                  <th>Order Date</th>
                  <th>Status</th>
                  <th>Assigned Designer</th>
                  <th>Edit/View</th>
                </tr>
              </thead>
              <tbody>
                <!-- Bootstrap Modal (Extra Large) For DO update-->
                <div
                  class="modal fade"
                  id="editModalDO"
                  tabindex="-1"
                  aria-labelledby="editModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog modal-xl">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabelDO"></h5>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        <form id="editFormDO">
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="donameUpdate" class="form-label"
                                >DO Name</label
                              >
                              <input
                                type="text"
                                class="form-control"
                                id="donameUpdate"
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Post Production</label
                              >
                              <select
                                style="padding: 7px"
                                id="postProductionDOUpdate"
                                class="form-select"
                                title="Post Production"
                              >
                                <option selected>Select Post Production</option>
                                <option>We Deliver (Our Vehicle)</option>
                                <option>We Deliver (Rented Truck)</option>
                                <option>Customer Pickup</option>
                                <option>Dropship</option>
                                <option>Send UPS/Fedex (Our Account)</option>
                                <option>
                                  Send UPS/Fedex (Customer Account)
                                </option>
                                <option>Freight Delivery</option>
                                <option>Install</option>
                                <option>Unknown</option>
                              </select>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Our Commitment Date</label
                              >
                              <input
                                type="date"
                                class="form-control"
                                id="Our_Commitment_DateUpdateDO"
                              />
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Customer Due Date</label
                              >
                              <input
                                type="date"
                                class="form-control"
                                id="Customer_Due_DateUpdateDo"
                              />
                            </div>
                          </div>
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="" class="form-label">Status</label>
                              <select
                                id="statusUpdateDO"
                                class="form-select"
                                title="Status"
                              >
                                <option selected>Select Status</option>
                                <option>Designer not Assigned</option>
                                <option>InProgress</option>
                                <option>Proof Sent for Approval</option>
                                <option>BOM & Process Path</option>
                                <option>Sent to Production</option>
                              </select>
                            </div>
                          </div>
                          <br />
                          <!-- Below is item details for update -->
                          <div
                            style="
                              border: 1px solid #ddd;
                              padding: 20px;
                              border-radius: 5px;
                            "
                          >
                            <h5
                              style="
                                margin-bottom: 20px;
                                font-size: 18px;
                                font-weight: bold;
                              "
                            >
                              Item Details
                            </h5>
                            <div id="itemContainerUpdateDO"></div>
                            <div
                              style="margin-top: 20px; text-align: left"
                            ></div>
                            <!--  -->
                            <div class="container">
                              <!-- Table Header -->
                              <!-- Container for dynamic rows -->
                              <div id="itemsContainerdo" class="mt-2">
                                <!-- Dynamic item rows for SO is in the below -->
                              </div>
                              <button
                                type="button"
                                class="btn btn-primary mt-3"
                                id="addItemdo"
                              >
                                + Add Item
                              </button>
                            </div>
                            <!-- jQuery Script to Add/Remove Rows  for Design order-->
                            <script>
                              // //<div style=" width: 10px; margin-top: 25px;" >
                              //   <span style="color:red; width: 10px; height:10px; "><i class="fa fa-x hoverCSS remove-itemso"></i></span>
                              //  </div>
                              $(document).ready(function () {
                                $("#addItemdo").click(function () {
                                  $("#itemsContainerdo").append(`
                                      <!-- Row of Fields -->
                                          <div class="row item-rowdo" id="" style="display: flex; align-items: center; flex-wrap: wrap; font-weight: bold;">
                                            <div style="flex: 1; min-width: 120px;">
                                                      <label class="form-label">Product Type</label>
                                                    <select id="productTypeAddRowDO" class="productTypeAddRowDO form-select">
                                                        <option>Select Type</option>
                                                    </select>
                                              </div>
                                              <div style="flex: 1; min-width: 120px;">
                                                  <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                                                  <input type="text" id="item-nameAddRowdo" placeholder="Item"
                                                      class="item-nameAddRowdo form-control form-control-sm"
                                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                              </div>
                                              <div style="flex: 1; min-width: 80px;">
                                                  <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                                                  <input type="number" id="item-codeAddRowdo" placeholder="Qty"
                                                      class="item-codeAddRowdo form-control form-control-sm"
                                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                              </div>
                            
                                             <div style="flex: 2; min-width: 200px;">
                                                    <label for="Description" class="form-label"
                                                        style="margin-bottom: 5px; display: block;">Description</label>
                                                    <textarea name="Description" id="Description_AddRowdo" rows="1"
                                                        class="Description_AddRowdo form-control form-control-sm" placeholder="Description"
                                                        style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; "></textarea>
                                                </div>
                            
                                              <div style="flex: 1; min-width: 120px;">
                                                  <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                                                  <select id="itemUnitAddRowdo" class="itemUnitAddRowdo form-select form-select-sm"
                                                      style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                                      <option>Select Unit</option>
                                                      <option>Box</option>
                                                      <option>Each</option>
                                                      <option>Feet</option>
                                                      <option>Sq Feet</option>
                                                      <option>Sheet</option>
                                                      <option>Pieces</option>
                                                      <option>Units</option>
                                                  </select>
                                              </div>
                                          </div>
                                          <hr style="margin-bottom: 8px; border: none;color: transparent; background-color: transparent;">
                              `);
                                });
                                // $(document).on(
                                //   "click",
                                //   ".remove-itemso",
                                //   function () {
                                //     $(this).closest(".item-rowso").remove();
                                //   }
                                // );
                              });
                            </script>
                            <!--  -->
                          </div>
                          <!--  -->
                          <div class="row mb-3">
                            <div class="col-md-3">
                              <label for="notes" class="form-label"
                                >Notes</label
                              >
                              <textarea
                                id="notesUpdateDO"
                                class="form-control"
                                rows="4"
                                placeholder=""
                              ></textarea>
                            </div>
                            <div class="col-md-3">
                              <label for="" class="form-label"
                                >Private Notes</label
                              >
                              <textarea
                                id="privateNoteUpdateDO"
                                class="form-control"
                                rows="4"
                                placeholder="Enter private notes here"
                              ></textarea>
                            </div>
                            <!-- <div class="col-md-3">
                                <label for="" class="col-sm-6 col-form-label">Down Payment (%)</label>
                                <input type="text" id="downPaymentPercentUpdateso" class="form-control" placeholder="0%">
                                <span style="color: darkred">Put only number not %</span>
                              </div> -->
                          </div>
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Close
                        </button>
                        <button
                          type="button"
                          class="btn btn-primary"
                          id="DOupdateChanges"
                        >
                          Save changes
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <script>
                  document.addEventListener("DOMContentLoaded", () => {
                    const editModalTitledo =
                      document.getElementById("editModalDO");
                    const modalTitleViewDO =
                      document.getElementById("editModalLabelDO");

                    editModalTitledo.addEventListener(
                      "show.bs.modal",
                      (event) => {
                        const buttonviewDO = event.relatedTarget; // Button that triggered the modal
                        const statusCellviewdo = buttonviewDO
                          .closest("tr")
                          .querySelector(".status-celldo")
                          .textContent.trim()
                          .toLowerCase();

                        // Set modal title based on status for Sales order
                        modalTitleViewDO.textContent =
                          statusCellviewdo === "designer not assigned"
                            ? "Edit Design Order"
                            : "View Design Order";
                      }
                    );
                  });
                </script>
                <!-- above script  -->
              </tbody>
            </table>
          </div>
        </div>

        <div class="form-section" id="formSectiondo">
          <div class="header-with-closedo">
            <h4>Create New Designorder</h4>
            <button class="close-buttondo" onclick="toggleFormdo(false)">
              X
            </button>
          </div>
          <br />
          <div style="font-weight: bold" id="createdesignorderForm">
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label">Order Date</label>
                <input
                  style="padding: 7px"
                  type="date"
                  id="dateFielddo"
                  placeholder="Put Date"
                  class="form-control"
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >DO Name<span style="color: red"> *</span></label
                >
                <input
                  style="padding: 7px"
                  type="text"
                  id="DOName"
                  class="form-control"
                  placeholder="Design order Name"
                  required
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Salesperson</label>
                <select
                  style="padding: 7px"
                  id="salespersonSelectDO"
                  name=""
                  title="s"
                  class="form-select"
                >
                  <option>Select Salesperson</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Design Type</label>
                <select
                  id="designTypeDO"
                  class="form-select"
                  style="padding: 7px"
                >
                  <option value="">Select Design Type</option>
                  <option value="Single">One DO for all lines</option>
                  <option value="Multiple">Multiple DO</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label">CRM Account Name</label>
                <input
                  type="text"
                  placeholder="CRM Account Name"
                  id="accountNameDO"
                  class="form-control"
                  readonly
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">CRM Contact Name</label>
                <select
                  style="padding: 7px"
                  id="contactSelectFieldDO"
                  class="form-select"
                  title="Contact name"
                >
                  <option value="" selected>Select a Contact</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Post Production <span style="color: red"> *</span></label
                >
                <select
                  style="padding: 7px"
                  id="postProductionDO"
                  class="form-select"
                  title="Post Production"
                >
                  <option selected>Select Post Production</option>
                  <option>We Deliver (Our Vehicle)</option>
                  <option>We Deliver (Rented Truck)</option>
                  <option>Customer Pickup</option>
                  <option>Dropship</option>
                  <option>Send UPS/Fedex (Our Account)</option>
                  <option>Send UPS/Fedex (Customer Account)</option>
                  <option>Freight Delivery</option>
                  <option>Install</option>
                  <option>Unknown</option>
                </select>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Our Commitment Date <span style="color: red"> *</span></label
                >
                <input
                  style="padding: 7px"
                  type="date"
                  id="ourCommitmentDateDO"
                  class="form-control"
                  placeholder="Our Commitment Date"
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label">Search Salesorder:</label>
                <input
                  type="text"
                  id="salesOrderSearchDO"
                  placeholder="Type to search..."
                  class="form-control"
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Select Salesorder:</label>
                <select
                  style="padding: 7px"
                  class="form-select"
                  id="salesOrderDropdownDO"
                >
                  <option value="">Loading...</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label" for="">Search Estimate:</label>
                <input
                  class="form-control"
                  style="padding: 7px"
                  type="text"
                  id="estimateSearchDo"
                  placeholder="Type to search..."
                />
              </div>
              <div class="col-md-3">
                <label class="form-label" for="">Select Estimate:</label>
                <select
                  style="padding: 7px"
                  class="form-select"
                  id="estimateDropdownDO"
                >
                  <option value="">Loading...</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="" class="form-label"
                  >Customer Due Date <span style="color: red"> *</span></label
                >
                <input
                  style="padding: 7px"
                  type="date"
                  id="customerDueDateDO"
                  class="form-control"
                  placeholder="Customer Due Date"
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Design Order Reference</label>
                <input
                  class="form-control"
                  style="padding: 7px"
                  type="text"
                  id="designOrderSearch"
                  placeholder="Enter Design Order..."
                />
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Select Design Order:</label>
                <select
                  style="padding: 7px"
                  class="form-select"
                  id="designOrderDropdown"
                >
                  <option value="">Select a Design Order</option>
                </select>
              </div>
            </div>
            <br />
            <!-- Item Details -->
            <div
              style="border: 1px solid #ddd; padding: 20px; border-radius: 5px"
            >
              <h5
                style="margin-bottom: 20px; font-size: 18px; font-weight: bold"
              >
                Item Details
              </h5>
              <div id="itemContainerDO">
                <div class="item-rowDO" style="margin-bottom: 20px">
                  <div
                    class="row"
                    id="row1DO"
                    style="display: flex; align-items: center; flex-wrap: wrap"
                  >
                    <div
                      onclick="removeRowDO(this)"
                      style="width: 10px; margin-top: 25px"
                    >
                      <span style="color: red; width: 10px; height: 10px"
                        ><i class="fa fa-x hoverCSS"></i
                      ></span>
                    </div>
                    <div style="flex: 1">
                      <label
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Product Type</label
                      >
                      <select
                        id="productTypeDO"
                        class="productTypeDO form-select"
                      >
                        <option>Select Type</option>
                      </select>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Item"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Item</label
                      >
                      <input
                        type="text"
                        id="itemNameDO"
                        placeholder="Item"
                        class="item-nameDO form-control form-control-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 2">
                      <label
                        for="Description"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Description</label
                      >
                      <textarea
                        name="Description"
                        id="itemdescDO"
                        rows="1"
                        class="Description-DO form-control form-control-sm"
                        placeholder="Description"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                          resize: none;
                        "
                      ></textarea>
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Qty"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Qty</label
                      >
                      <input
                        type="number"
                        id="itemqtyDO"
                        placeholder="Qty"
                        class="item-codeDO form-control form-control-sm"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      />
                    </div>
                    <div style="flex: 1">
                      <label
                        for="Unit"
                        class="form-label"
                        style="margin-bottom: 5px; display: block"
                        >Unit</label
                      >
                      <select
                        id=""
                        class="itemUnitDO form-select"
                        style="
                          width: 100%;
                          padding: 6px;
                          font-size: 14px;
                          border: 1px solid #ccc;
                          border-radius: 4px;
                        "
                      >
                        <option>Select a Unit</option>
                        <option>Box</option>
                        <option>Each</option>
                        <option>Feet</option>
                        <option>Sq Feet</option>
                        <option>Sheet</option>
                        <option>Pieces</option>
                        <option>Units</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
              <div style="margin-top: 20px; text-align: left">
                <button
                  onclick="addRowDO()"
                  class="btn btn-primary btn-sm"
                  style="font-size: 14px"
                >
                  + Add Item
                </button>
              </div>
            </div>
            <br />
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="notes" class="form-label">Notes</label>
                <textarea
                  id="notesDO"
                  class="form-control"
                  rows="4"
                  placeholder="Enter notes here"
                ></textarea>
              </div>
              <div class="col-md-3">
                <label for="privateNotes" class="form-label"
                  >Private Notes</label
                >
                <textarea
                  id="privateNotesDO"
                  class="form-control"
                  rows="4"
                  placeholder="Enter private notes here"
                ></textarea>
              </div>
              <div class="col-md-3">
                <label for="" class="form-label">Status</label>
                <select id="statusDO" class="form-select" title="Status">
                  <option selected>Select Status</option>
                  <option>Designer not Assigned</option>
                  <option>InProgress</option>
                  <option>Proof Sent for Approval</option>
                  <option>BOM & Process Path</option>
                  <option>Sent to Production</option>
                </select>
              </div>
            </div>
            <!-- Reference URL -->
            <h4 class="mt-4">Reference URL</h4>
            <div class="url-fields row">
              <div class="col-md-4">
                <input
                  id="urlEs1DO"
                  type="url"
                  class="form-control"
                  placeholder="URL 1"
                />
              </div>
              <div class="col-md-4">
                <input
                  id="urlEs2DO"
                  type="url"
                  class="form-control"
                  placeholder="URL 2"
                />
              </div>
              <div class="col-md-4">
                <input
                  id="urlEs3DO"
                  type="url"
                  class="form-control"
                  placeholder="URL 3"
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <h4 class="mt-4">Attachments</h4>

                <div id="attachments_containerDO">
                  <label for="" class="form-label">File Upload</label>
                  <input
                    type="file"
                    multiple
                    id="fileInputCustomerDO"
                    class="form-control"
                    title="file"
                  />
                </div>
                <p style="color: #007bff; margin-top: 5px">
                  You can select multiple files.
                </p>
              </div>
              <div class="col-md-6">
                <h4 class="mt-4">Upload Proofs</h4>
                <div id="attachments_containerPrivateSO">
                  <label for="" class="form-label">File Upload</label>
                  <input
                    type="file"
                    multiple
                    id="fileInputPrivateSO"
                    class="form-control"
                    title="file"
                  />
                </div>
                <p style="color: #007bff; margin-top: 5px">
                  You can select multiple files.
                </p>
              </div>
            </div>
            <br />
            <p
              id="errorMessageDO"
              style="font-size: 13px; color: red; display: none"
            >
              (*) Fields are required!
            </p>
            <div class="form-buttons">
              <button type="button" class="submit-button" id="doBtn">
                Submit
              </button>
              <button
                type="button"
                class="cancel-button"
                onclick="toggleFormdo(false)"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      //below script is for QT toggle
      function toggleForm(showForm) {
        const formSection = document.getElementById("formSection");
        const listView = document.getElementById("listView");
        const listViewHeader = document.getElementById("listViewHeader"); // Header element
        const addButton = document.querySelector(".add-button"); // The "+ Create Estimate" button

        if (showForm) {
          formSection.style.display = "block";
          listView.style.display = "none";
          listViewHeader.style.display = "none"; // Hide the header text
          addButton.style.display = "none"; // Hide the "+ Create Estimate" button
          window.scrollTo({ top: formSection.offsetTop, behavior: "smooth" }); // Scroll to the form
        } else {
          formSection.style.display = "none";
          listView.style.display = "block";
          listViewHeader.style.display = "block"; // Show the header text
          addButton.style.display = "inline-block"; // Show the "+ Create Estimate" button
        }
      }
      //below script is for SO toggle
      function toggleFormso(showFormso) {
        const formSectionso = document.getElementById("formSectionso");
        const listViewso = document.getElementById("listViewso");
        const listViewHeaderso = document.getElementById("listViewHeaderso"); // Header element
        const addButtonso = document.querySelector(".addbuttonso"); // The "+ Create Estimate" button

        if (showFormso) {
          formSectionso.style.display = "block";
          listViewso.style.display = "none";
          listViewHeaderso.style.display = "none"; // Hide the header text
          addButtonso.style.display = "none"; // Hide the "+ Create Estimate" button
          window.scrollTo({ top: formSectionso.offsetTop, behavior: "smooth" }); // Scroll to the form
        } else {
          formSectionso.style.display = "none";
          listViewso.style.display = "block";
          listViewHeaderso.style.display = "block"; // Show the header text
          addButtonso.style.display = "inline-block"; // Show the "+ Create Estimate" button
        }
      }
      //below script is for DO toggle
      function toggleFormdo(showFormdo) {
        const formSectiondo = document.getElementById("formSectiondo");
        const listViewdo = document.getElementById("listViewdo");
        const listViewHeaderdo = document.getElementById("listViewHeaderdo"); // Header element
        const addButtondo = document.querySelector(".addbuttondo"); // The "+ Create Estimate" button

        if (showFormdo) {
          formSectiondo.style.display = "block";
          listViewdo.style.display = "none";
          listViewHeaderdo.style.display = "none"; // Hide the header text
          addButtondo.style.display = "none"; // Hide the "+ Create Estimate" button
          window.scrollTo({ top: formSectiondo.offsetTop, behavior: "smooth" }); // Scroll to the form
        } else {
          formSectiondo.style.display = "none";
          listViewdo.style.display = "block";
          listViewHeaderdo.style.display = "block"; // Show the header text
          addButtondo.style.display = "inline-block"; // Show the "+ Create Estimate" button
        }
      }
    </script>
    <!-- item script details for Estimate-->
    <script>
      function addRow() {
        const itemContainer = document.getElementById("itemContainer");
        const newRow = document.createElement("div");
        newRow.classList.add("item-row");
        //2 - add items in for item row dinamically
        let productTypeOption;
        window.productTypeContent.forEach((productTypeData) => {
          productTypeOption += `<option value=${productTypeData.ID}>${productTypeData.Type_field}</option>`;
        }); //end of forEach
        newRow.innerHTML = `
                    <!-- Row of Fields -->
                    <div class="row" id="row1" style="display: flex; align-items: center; gap: 3px; flex-wrap: wrap;">
                         
                      <div onclick="removeRow(this)" style=" width: 10px; margin-top: 25px;" >
                          <span  style="color:red; width: 10px; height:10px; "><i class="fa fa-x hoverCSS"></i></span>
                        </div>
                      
                      <div style="flex: 1; min-width: 120px;">
                                <label class="form-label">Product Type</label>
                              <select id="productTypeQT" class="productTypeQT form-select">
                                  <option>Select Type</option>
                                          ${productTypeOption}

                              </select>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                            <input type="text" id="itemNameQT" placeholder="Item"
                                class="item-name form-control form-control-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                        <div style="flex: 1; min-width: 80px;">
                            <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                            <input type="number" id="itemqtyQT" placeholder="Qty"
                                class="item-code form-control form-control-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>

                       <div style="flex: 2; min-width: 200px;">
                              <label for="Description" class="form-label"
                                  style="margin-bottom: 5px; display: block;">Description</label>
                              <textarea name="Description" id="itemdescT" rows="1"
                                  class="Description-QT form-control form-control-sm" placeholder="Description"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; "></textarea>
                          </div>

                        <div style="flex: 1; min-width: 120px;">
                            <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                            <select id="itemUnitQT" class="itemUnitQT form-select form-select-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                <option>Box</option>
                                <option>Each</option>
                                <option>Feet</option>
                                <option>Sq Feet</option>
                                <option>Sheet</option>
                                <option>Pieces</option>
                                <option>Units</option>
                            </select>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Cost" class="form-label" style="margin-bottom: 5px; display: block; font-size: medium;">Piece Cost ($)</label>
                            <input type="number" id="priceCostQT" class=" priceCostQT form-control form-control-sm"
                                placeholder="Piece Cost ($)"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Markup" class="form-label" style="margin-bottom: 5px; display: block;">Markup
                                (%)</label>
                            <input type="number" id="markupQT" class="markupQT form-control form-control-sm"
                                placeholder="Markup (%)"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                    </div>
                    <hr style="margin-bottom: 8px; border: none;color: transparent; background-color: transparent;">
              `;
        itemContainer.appendChild(newRow);
      }
      function removeRow(button) {
        const row = button.parentNode;
        row.parentNode.removeChild(row);
      }
    </script>
    <!-- item script details for Sales order -->
    <script>
      function addRowSO() {
        const itemContainerSO = document.getElementById("itemContainerSO");
        const newRowSO = document.createElement("div");
        newRowSO.classList.add("item-rowSO");
        //2 - add items in for item row dinamically
        let productTypeOptionSO;
        window.productTypeContentSO.forEach((productTypeDataSO) => {
          productTypeOptionSO += `<option value=${productTypeDataSO.ID}>${productTypeDataSO.Type_field}</option>`;
        }); //end of forEach
        newRowSO.innerHTML = `
                    <!-- Row of Fields -->
                    <div class="row" id="row1SO" style="display: flex; align-items: center; gap: 3px; flex-wrap: wrap;">
                         
                      <div onclick="removeRowSO(this)" style=" width: 10px; margin-top: 25px;" >
                          <span  style="color:red; width: 10px; height:10px; "><i class="fa fa-x hoverCSS"></i></span>
                        </div>
                      
                      <div style="flex: 1; min-width: 120px;">
                                <label class="form-label">Product Type</label>
                              <select id="productTypeSO" class="productTypeSO form-select">
                                  <option>Select Type</option>
                                  ${productTypeOptionSO}
                              </select>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                            <input type="text" id="item-nameSO" placeholder="Item"
                                class="item-nameSO form-control form-control-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                        <div style="flex: 1; min-width: 80px;">
                            <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                            <input type="number" id="itemqtySO" placeholder="Qty"
                                class="item-codeSO form-control form-control-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>

                       <div style="flex: 2; min-width: 200px;">
                              <label for="Description" class="form-label"
                                  style="margin-bottom: 5px; display: block;">Description</label>
                              <textarea name="Description" id="itemdescSO" rows="1"
                                  class="Description-SO form-control form-control-sm" placeholder="Description"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; "></textarea>
                          </div>

                        <div style="flex: 1; min-width: 120px;">
                            <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                            <select id="itemUnitSO" class="itemUnitSO form-select form-select-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                <option>Box</option>
                                <option>Each</option>
                                <option>Feet</option>
                                <option>Sq Feet</option>
                                <option>Sheet</option>
                                <option>Pieces</option>
                                <option>Units</option>
                            </select>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Cost" class="form-label" style="margin-bottom: 5px; display: block; font-size: medium;">Piece Cost
                                ($)</label>
                            <input type="number" id="priceCostSO" class=" priceCostSO form-control form-control-sm"
                                placeholder="Piece Cost ($)"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Markup" class="form-label" style="margin-bottom: 5px; display: block;">Markup
                                (%)</label>
                            <input type="number" id="markupSO" class="markupSO form-control form-control-sm"
                                placeholder="Markup (%)"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                    </div>
                    <hr style="margin-bottom: 8px; border: none;color: transparent; background-color: transparent;">
              `;
        itemContainerSO.appendChild(newRowSO);
      }
      function removeRowSO(button) {
        const rowSO = button.parentNode;
        rowSO.parentNode.removeChild(rowSO);
      }
    </script>
    <!-- item script details for Design order -->
    <script>
      function addRowDO() {
        const itemContainerDO = document.getElementById("itemContainerDO");
        const newRowDO = document.createElement("div");
        newRowDO.classList.add("item-rowDO");
        //2 - add items in for item row dinamically
        let productTypeOptionDO;
        window.productTypeContentDO.forEach((productTypeDataDO) => {
          productTypeOptionDO += `<option value=${productTypeDataDO.ID}>${productTypeDataDO.Type_field}</option>`;
        }); //end of forEach
        newRowDO.innerHTML = `
                    <!-- Row of Fields -->
                    <div class="row" id="row1DO" style="display: flex; align-items: center; gap: 3px; flex-wrap: wrap;">
                      
                      <div onclick="removeRowDO(this)" style=" width: 10px; margin-top: 25px;" >
                          <span  style="color:red; width: 10px; height:10px; "><i class="fa fa-x hoverCSS"></i></span>
                        </div>
                      
                      <div style="flex: 1;">
                                <label class="form-label">Product Type</label>
                              <select id="productTypeDO" class="productTypeDO form-select">
                                  <option>Select Type</option>
                                  ${productTypeOptionDO}
                              </select>
                        </div>
                        <div style="flex: 1; min-width: 120px;">
                            <label for="Item" class="form-label" style="margin-bottom: 5px; display: block;">Item</label>
                            <input type="text" id="itemNameDO" placeholder="Item"
                                class="item-nameDO form-control form-control-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                       <div style="flex: 2; min-width: 200px;">
                              <label for="Description" class="form-label"
                                  style="margin-bottom: 5px; display: block;">Description</label>
                              <textarea name="Description" id="itemdescDO" rows="1"
                                  class="Description-DO form-control form-control-sm" placeholder="Description"
                                  style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px; "></textarea>
                          </div>
                          <div style="flex: 1; min-width: 80px;">
                            <label for="Qty" class="form-label" style="margin-bottom: 5px; display: block;">Qty</label>
                            <input type="number" id="itemqtyDO" placeholder="Qty"
                                class="item-codeDO form-control form-control-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                         <div style="flex: 1; min-width: 120px;">
                            <label for="Unit" class="form-label" style="margin-bottom: 5px; display: block;">Unit</label>
                            <select id="itemUnitDO" class="itemUnitDO form-select form-select-sm"
                                style="width: 100%; padding: 6px; font-size: 14px; border: 1px solid #ccc; border-radius: 4px;">
                                <option>Select a Uunit</option>
                                <option>Box</option>
                                <option>Each</option>
                                <option>Feet</option>
                                <option>Sq Feet</option>
                                <option>Sheet</option>
                                <option>Pieces</option>
                                <option>Units</option>
                            </select>
                        </div>
                    </div>
                    <hr style="margin-bottom: 8px; border: none;color: transparent; background-color: transparent;">
              `;
        itemContainerDO.appendChild(newRowDO);
      }
      function removeRowDO(button) {
        const rowDO = button.parentNode;
        rowDO.parentNode.removeChild(rowDO);
      }
    </script>
    <!-- Post_Production_dropdown_SO Field Group -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const dropdown = document.getElementById("Post_Production_dropdown_SO");
        dropdown.dispatchEvent(new Event("change"));
      });

      document
        .getElementById("Post_Production_dropdown_SO")
        .addEventListener("change", function () {
          // Hide all field groups
          const allFieldGroups = document.querySelectorAll(".field-group");
          allFieldGroups.forEach((group) => (group.style.display = "none"));
          // Show the selected field group
          const selectedValue = this.value;
          if (selectedValue) {
            document.getElementById(selectedValue).style.display = "block";
          }
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SweetAlert2 JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </body>
</html>
